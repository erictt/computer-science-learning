<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Eric&#39;s CS Notes
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

<meta name="generator" content="Hexo 6.0.0"></head>


<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>ERIC&#39;S CS NOTES</span>
  </a>
</div>

    <div class="book-menu">
  <!--
## Introduction to Probability

* [Unit 1: Probability models and axioms](/introduction-to-probability/unit-1/index.html)
* [Unit 2: Conditioning and independence](/introduction-to-probability/unit-2/index.html)
* [Unit 3: Counting](/introduction-to-probability/unit-3/index.html)
* [Unit 4: Discrete random variables](/introduction-to-probability/unit-4/index.html)
* [Unit 5: Continuous random variables](/introduction-to-probability/unit-5/index.html)
* [Unit 6: Further topics on random variables](/introduction-to-probability/unit-6/index.html)
* [Unit 7: Bayesian inference](/introduction-to-probability/unit-7/index.html)
* [Unit 8: Limit theorems and classical statistics](/introduction-to-probability/unit-8/index.html)
* [Unit 9: Bernoulli and Poisson processes](/introduction-to-probability/unit-9/index.html)
* [Unit 10: Markov chains](/introduction-to-probability/unit-10/index.html)
-->
<!--
## Multivariable Calculus

* [Unit 1: Thinking about multivariable functions](/multivariable-calculus/unit-1/index.html)
* [Unit 2: Derivatives of multivariable functions](/multivariable-calculus/unit-2/index.html)

* [Unit 3: Applications of multivariable derivatives](/multivariable-calculus/unit-3/index.html)
* [Unit 4: Integrating multivariable functions](/multivariable-calculus/unit-4/index.html)
* [Unit 5: Green's, Stokes', and the divergence theorems](/multivariable-calculus/unit-5/index.html)
-->
<h2 id="algorithms-part-ii"><a class="markdownIt-Anchor" href="#algorithms-part-ii"></a> Algorithms: Part II</h2>
<ul>
<li><a href="/algorithms-2/week-1/index.html">Week 1 - Undirected Graph &amp; Directed Graph</a></li>
<li><a href="/algorithms-2/week-2/index.html">Week 2 - Minimum Spanning Trees &amp; Shortest Path</a></li>
<li><a href="/algorithms-2/week-3/index.html">Week 3 - Maximum Flow and Minimum Cut &amp; String Sort</a></li>
<li><a href="/algorithms-2/week-4/index.html">Week 4 - Tries &amp; Substring Search</a></li>
<li><a href="/algorithms-2/week-5/index.html">Week 5 - Regular Expressions</a></li>
<li><a href="/algorithms-2/week-6/index.html">Week 6 - Reductions</a></li>
</ul>
<h2 id="algorithms-part-i"><a class="markdownIt-Anchor" href="#algorithms-part-i"></a> Algorithms: Part I</h2>
<ul>
<li><a href="/algorithms-1/week-1/index.html">Week 1 - Union-Find &amp; Analysis of Algorithms</a></li>
<li><a href="/algorithms-1/week-2/index.html">Week 2 - Stacks and Queues &amp; Elementary Sorts</a></li>
<li><a href="/algorithms-1/week-3/index.html">Week 3 - Mergesort &amp; Quicksort</a></li>
<li><a href="/algorithms-1/week-4/index.html">Week 4 - Priority Queues &amp; Elementary Symbols</a></li>
<li><a href="/algorithms-1/week-5/index.html">Week 5 - Balanced Search Trees</a></li>
<li><a href="/algorithms-1/week-6/index.html">Week 6 - Hash Tables</a></li>
</ul>
<h2 id="introduction-to-software-design-and-architecture"><a class="markdownIt-Anchor" href="#introduction-to-software-design-and-architecture"></a> Introduction to Software Design and Architecture</h2>
<ul>
<li><a href="/introduction-to-software-design-and-architecture/design-pattern/index.html">Design Pattern</a></li>
</ul>
<h2 id="calculus-two-sequences-and-series"><a class="markdownIt-Anchor" href="#calculus-two-sequences-and-series"></a> Calculus Two: Sequences and Series</h2>
<ul>
<li><a href="/calculus-two/week-1/index.html">Week 1 - Sequences</a></li>
<li><a href="/calculus-two/week-2/index.html">Week 2 - Series</a></li>
<li><a href="/calculus-two/week-3/index.html">Week 3 - Convergence Tests</a></li>
<li><a href="/calculus-two/week-4/index.html">Week 4 - Alternating Series</a></li>
<li><a href="/calculus-two/week-5/index.html">Week 5 - Power Series</a></li>
<li><a href="/calculus-two/week-6/index.html">Week 6 - Taylor Series</a></li>
</ul>
<h2 id="laff-linear-algebra"><a class="markdownIt-Anchor" href="#laff-linear-algebra"></a> LAFF Linear Algebra</h2>
<ul>
<li><a href="/laff-linear-algebra/week-1/index.html">Week 1 - Vectors in Linear Algebra</a></li>
<li><a href="/laff-linear-algebra/week-2/index.html">Week 2 - Linear Transformations and Matrices</a></li>
<li><a href="/laff-linear-algebra/week-3/index.html">Week 3 - Matrix-Vector Operations</a></li>
<li><a href="/laff-linear-algebra/week-4/index.html">Week 4 - Matrix-Vector to Matrix-Matrix Multiplication</a></li>
<li><a href="/laff-linear-algebra/week-5/index.html">Week 5 - Matrix- Matrix Multiplication</a></li>
<li><a href="/laff-linear-algebra/week-6/index.html">Week 6 - Gaussian Elimination</a></li>
<li><a href="/laff-linear-algebra/week-7/index.html">Week 7 - More Gaussian Elimination and Matrix Inversion</a></li>
<li><a href="/laff-linear-algebra/week-8/index.html">Week 8 - More on Matrix Inversion</a></li>
<li><a href="/laff-linear-algebra/week-9/index.html">Week 9 - Vector Spaces</a></li>
<li><a href="/laff-linear-algebra/week-10/index.html">Week 10 - Vector Spaces, Orthogonality, and Linear Least-Squares</a></li>
<li><a href="/laff-linear-algebra/week-11/index.html">Week 11 - Orthogonal Projection, Low Rank Approximation, and Orthogonal Bases</a></li>
<li><a href="/laff-linear-algebra/week-12/index.html">Week 12 - Eigenvalues and Eigenvectors</a></li>
</ul>
<h2 id="stanford-machine-learning"><a class="markdownIt-Anchor" href="#stanford-machine-learning"></a> Stanford Machine Learning</h2>
<ul>
<li><a href="/stanford-machine-learning/week-1/index.html">Week 1 - Introduction</a></li>
<li><a href="/stanford-machine-learning/week-2/index.html">Week 2 - Linear Regression with Multiple Variables</a></li>
<li><a href="/stanford-machine-learning/week-3/index.html">Week 3 - Logistic Regression &amp; Regularization</a></li>
<li><a href="/stanford-machine-learning/week-4/index.html">Week 4 - Neural Networks: Representation</a></li>
<li><a href="/stanford-machine-learning/week-5/index.html">Week 5 - Neural Networks: Learning</a></li>
<li><a href="/stanford-machine-learning/week-6a/index.html">Week 6a - Advice for Applying Machine Learning</a></li>
<li><a href="/stanford-machine-learning/week-6b/index.html">Week 6b - Machine Learning System Design</a></li>
<li><a href="/stanford-machine-learning/week-7/index.html">Week 7 - Support Vector Machines</a></li>
<li><a href="/stanford-machine-learning/week-8/index.html">Week 8 - Unsupervised Learning &amp; Dimensionality Reduction</a></li>
<li><a href="/stanford-machine-learning/week-9a/index.html">Week 9a - Anomaly Detection</a></li>
<li><a href="/stanford-machine-learning/week-9b/index.html">Week 9b - Recommender Systems</a></li>
<li><a href="/stanford-machine-learning/week-10/index.html">Week 10 - Large Scale Machine Learning</a></li>
<li><a href="/stanford-machine-learning/week-11/index.html">Week 11 - Application Example: Photo OCR</a></li>
</ul>
<h2 id="calculus-one"><a class="markdownIt-Anchor" href="#calculus-one"></a> Calculus One</h2>
<ul>
<li><a href="/calculus-one/week-2-3/index.html">Week 2-3 - Functions &amp; Limits</a></li>
<li><a href="/calculus-one/week-4/index.html">Week 4 - The Beginning of Derivatives</a></li>
<li><a href="/calculus-one/week-5/index.html">Week 5 - Techniques of Differentiation</a></li>
<li><a href="/calculus-one/week-6/index.html">Week 6 - Chain Rule</a></li>
<li><a href="/calculus-one/week-7/index.html">Week 7 - Derivatives of Trigonometric Functions</a></li>
<li><a href="/calculus-one/week-8/index.html">Week 8 - Derivatives in the Real World</a></li>
<li><a href="/calculus-one/week-9/index.html">Week 9 - Optimization</a></li>
<li><a href="/calculus-one/week-10/index.html">Week 10 - Linear Approximation</a></li>
<li><a href="/calculus-one/week-11-12/index.html">Week 11-12 - Antidifferentiation &amp; Integration</a></li>
<li><a href="/calculus-one/week-13/index.html">Week 13 - Fundamental Theorem of Calculus</a></li>
<li><a href="/calculus-one/week-14/index.html">Week 14 - Substitution Rule</a></li>
<li><a href="/calculus-one/week-15/index.html">Week 15 - Techniques of Integration</a></li>
<li><a href="/calculus-one/week-16/index.html">Week 16 - Applications of Integration</a></li>
</ul>
<h2 id="computational-thinking"><a class="markdownIt-Anchor" href="#computational-thinking"></a> Computational Thinking</h2>
<ul>
<li><a href="/computational-thinking/lecture-1/index.html">Lecture 1 - Optimization and Knapsack Problem</a></li>
<li><a href="/computational-thinking/lecture-2/index.html">Lecture 2 - Decision Trees and Dynamic Programming</a>
<ul>
<li><a href="/computational-thinking/lecture-2-powerset/index.html">Exercise: Power Set Function</a></li>
</ul>
</li>
<li><a href="/computational-thinking/lecture-3/index.html">Lecture 3 - Graphs</a></li>
<li><a href="/computational-thinking/lecture-4-5/index.html">Lecture 4-5 - Plotting</a></li>
<li><a href="/computational-thinking/lecture-6-7/index.html">Lecture 6-7 - Stochastic Programs &amp; Inferential Statistics</a></li>
<li><a href="/computational-thinking/lecture-8/index.html">Lecture 8 - Monte Carlo Simulation</a></li>
<li><a href="/computational-thinking/lecture-9/index.html">Lecture 9 - Sampling and Standard Error</a></li>
<li><a href="/computational-thinking/lecture-10-11/index.html">Lecture 10-11 - Experimental Data</a></li>
<li><a href="/computational-thinking/lecture-12/index.html">Lecture 12 - Machine Learning</a></li>
<li><a href="/computational-thinking/lecture-13/index.html">Lecture 13 - Statistical Abuses</a></li>
</ul>
<h2 id="effective-thinking-through-mathematics"><a class="markdownIt-Anchor" href="#effective-thinking-through-mathematics"></a> Effective Thinking Through Mathematics</h2>
<ul>
<li><a href="/effective-thinking-through-mathematics/note/index.html">Note</a></li>
<li><a href="/effective-thinking-through-mathematics/week-4-telling-the-story-of-infinity/index.html">Week 4 (/Telling the Story of Infinity)</a></li>
<li><a href="/effective-thinking-through-mathematics/week-5-telling-the-story-of-the-euler-circuit-theorem/index.html">Week 5 (/Telling the Story of Euler Circuit Theorem)</a></li>
</ul>
<h2 id="cs50-introduction-to-computer-science"><a class="markdownIt-Anchor" href="#cs50-introduction-to-computer-science"></a> CS50 Introduction to Computer Science</h2>
<ul>
<li><a href="/cs50/week-1/index.html">Week 1 - C</a></li>
<li><a href="/cs50/week-2/index.html">Week 2 - Arrays</a></li>
<li><a href="/cs50/week-3/index.html">Week 3 - Algorithms</a></li>
<li><a href="/cs50/week-4/index.html">Week 4 - Memory</a></li>
<li><a href="/cs50/week-5/index.html">Week 5 - Data Structures</a></li>
<li><a href="/cs50/week-6/index.html">Week 6 - HTTP</a></li>
<li><a href="/cs50/week-7-10/index.html">Week 7-10 - Machine Learning/Python/SQL/Javascript</a></li>
</ul>
<h2 id="others"><a class="markdownIt-Anchor" href="#others"></a> Others</h2>
<ul>
<li><a href="/symbols/index.html">Symbols of Mathematics</a></li>
<li><a href="/glossary/index.html">Glossary</a></li>
</ul>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')  
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h1 id="week-4-tries-substring-search"><a class="markdownIt-Anchor" href="#week-4-tries-substring-search"></a> Week 4 - Tries &amp; Substring Search</h1>
<h2 id="tries"><a class="markdownIt-Anchor" href="#tries"></a> Tries</h2>
<ul>
<li>[from re<strong>trie</strong>val, but pronounced “try”]</li>
<li>Store characters in nodes (not keys).</li>
<li>Each node has <strong>R</strong> children, one for each possible character.
<ul>
<li><code>int R = 256; // extended ASCII</code></li>
</ul>
</li>
<li>
<img src="https://i.imgur.com/jSIIGuR.jpg" style="width:600px" />
</li>
</ul>
<h3 id="java-implementation"><a class="markdownIt-Anchor" href="#java-implementation"></a> Java implementation</h3>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TrieST</span>&lt;Value&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> <span class="number">256</span>; <span class="comment">// extended ASCII</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Node</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123; </span><br><span class="line">        <span class="keyword">private</span> Object value; <span class="comment">// use Object instead of Value since no generic array creation in Java</span></span><br><span class="line">        <span class="keyword">private</span> Node[] next = <span class="keyword">new</span> <span class="title class_">Node</span>[R]; <span class="comment">// each node has an array of links and a value</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(String key, Value val)</span> &#123; root = put(root, key, val, <span class="number">0</span>); &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">put</span><span class="params">(Node x, String key, Value val, <span class="type">int</span> d)</span> &#123; </span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span>) x = <span class="keyword">new</span> <span class="title class_">Node</span>(); </span><br><span class="line">        <span class="keyword">if</span> (d == key.length()) &#123; x.val = val; <span class="keyword">return</span> x; &#125; </span><br><span class="line">        <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> key.charAt(d); </span><br><span class="line">        x.next[c] = put(x.next[c], key, val, d+<span class="number">1</span>); </span><br><span class="line">        <span class="keyword">return</span> x; </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(String key)</span> &#123; <span class="keyword">return</span> get(key) != <span class="literal">null</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Value <span class="title function_">get</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">x</span> <span class="operator">=</span> get(root, key, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> (Value) x.val;  <span class="comment">// cast needed</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">get</span><span class="params">(Node x, String key, <span class="type">int</span> d)</span> &#123; </span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>; </span><br><span class="line">        <span class="keyword">if</span> (d == key.length()) <span class="keyword">return</span> x; </span><br><span class="line">        <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> key.charAt(d); </span><br><span class="line">        <span class="keyword">return</span> get(x.next[c], key, d+<span class="number">1</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Performance: Fast search hit and even Trie representation faster search miss, but wastes space.</p>
</li>
<li>
<p>Deletion in an R-way trie</p>
<ul>
<li>Find the node corresponding to key and set value to null.</li>
<li>If node has null value and all null links, remove that node (and recur).</li>
<li>
<img src="https://i.imgur.com/Dla0UOL.jpg" style="width:500px" />
</li>
</ul>
</li>
</ul>
<h3 id="ternary-search-triestst"><a class="markdownIt-Anchor" href="#ternary-search-triestst"></a> Ternary search tries(TST)</h3>
<ul>
<li>
<p>To solve the problem that R-way tries took too much space.</p>
</li>
<li>
<p>Store characters and values in nodes (not keys).</p>
</li>
<li>
<p>Each node has <strong>3</strong> children: smaller (left), equal (middle), larger (right).</p>
</li>
<li>
<img src="https://i.imgur.com/oXo6XIl.jpg" style="width:600px" />
</li>
<li>
<p>Java implementation</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TST</span>&lt;Value&gt; &#123; <span class="keyword">private</span> Node root;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Value val;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">char</span> c;</span><br><span class="line">        <span class="keyword">private</span> Node left, mid, right; </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(String key, Value val)</span> &#123; root = put(root, key, val, <span class="number">0</span>); &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">put</span><span class="params">(Node x, String key, Value val, <span class="type">int</span> d)</span> &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> key.charAt(d); </span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span>) &#123; x = <span class="keyword">new</span> <span class="title class_">Node</span>(); x.c = c; &#125; </span><br><span class="line">        <span class="keyword">if</span> (c &lt; x.c) x.left = put(x.left, key, val, d); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c &gt; x.c) x.right = put(x.right, key, val, d); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (d &lt; key.length() - <span class="number">1</span>) x.mid = put(x.mid, key, val, d+<span class="number">1</span>); </span><br><span class="line">        <span class="keyword">else</span> x.val = val;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(String key)</span> &#123; <span class="keyword">return</span> get(key) != <span class="literal">null</span>; &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Value <span class="title function_">get</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">x</span> <span class="operator">=</span> get(root, key, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> x.val; </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Node <span class="title function_">get</span><span class="params">(Node x, String key, <span class="type">int</span> d)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>; </span><br><span class="line">        <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> key.charAt(d); </span><br><span class="line">        <span class="keyword">if</span> (c &lt; x.c) <span class="keyword">return</span> get(x.left, key, d); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (c &gt; x.c) <span class="keyword">return</span> get(x.right, key, d); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (d &lt; key.length() - <span class="number">1</span>) <span class="keyword">return</span> get(x.mid, key, d+<span class="number">1</span>); </span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="tst-with-r2-branching-at-root"><a class="markdownIt-Anchor" href="#tst-with-r2-branching-at-root"></a> TST with R^2 branching at root</h4>
<ul>
<li>Hybrid of R-way trie and TST.
<ul>
<li>Do R^2 -way branching at root.</li>
<li>Each of R^2 root nodes points to a TST.</li>
</ul>
</li>
<li>
<img src="https://i.imgur.com/pXgm3LU.jpg" style="width:600px" />
</li>
</ul>
<h4 id="string-symbol-table-implementation-cost-summary"><a class="markdownIt-Anchor" href="#string-symbol-table-implementation-cost-summary"></a> String symbol table implementation cost summary</h4>
<img src="https://i.imgur.com/cBcTtvv.jpg" style="width:500px" />
<ul>
<li>TST vs. hashing
<ul>
<li>Hashing.
<ul>
<li>Need to examine entire key.</li>
<li>Search hits and misses cost about the same.</li>
<li>Performance relies on hash function.</li>
<li>Does not support ordered symbol table operations.</li>
</ul>
</li>
<li>TSTs.
<ul>
<li>Works only for strings (or digital keys).</li>
<li>Only examines just enough key characters.</li>
<li>Search miss may involve only a few characters.</li>
<li>Supports ordered symbol table operations (plus others!).</li>
</ul>
</li>
<li>Bottom line. TSTs are:
<ul>
<li>Faster than hashing (especially for search misses).</li>
<li>More flexible than red-black BSTs.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="character-based-operations"><a class="markdownIt-Anchor" href="#character-based-operations"></a> Character-based Operations</h3>
<ul>
<li>
<p>Prefix match. Find all keys in a symbol table starting with a given prefix.</p>
<ul>
<li>
<img src="https://i.imgur.com/P4cMOAB.jpg" style="width:600px" />
</li>
</ul>
</li>
<li>
<p>Longest prefix. Find longest key in symbol table that is a prefix of query string.</p>
<ul>
<li>
<img src="https://i.imgur.com/L2406ZN.jpg" style="width:600px" />
</li>
</ul>
</li>
<li>
<p>Wildcard match. Keys that match .he: she and the.</p>
</li>
</ul>
<h2 id="substring-search"><a class="markdownIt-Anchor" href="#substring-search"></a> Substring Search</h2>
<ul>
<li>Goal. Find pattern of length M in a text of length N.
<ul>
<li>typically N &gt;&gt; M</li>
</ul>
</li>
</ul>
<h3 id="brute-force-substring-search"><a class="markdownIt-Anchor" href="#brute-force-substring-search"></a> Brute-force substring search</h3>
<ul>
<li>
<p>Check for pattern starting at each text position.</p>
</li>
<li>
<img src="https://i.imgur.com/1gp7R29.jpg" style="width:400px" />
<ul>
<li>worst case: ~M N char compares.</li>
</ul>
</li>
<li>
<p>Brute-force algorithm needs <strong>backup</strong> for every mismatch.</p>
<ul>
<li>
<img src="https://i.imgur.com/SbLNDHL.jpg" style="width:400px" />
</li>
</ul>
</li>
<li>
<p>alternate implementaion for backup.</p>
<ul>
<li>
<img src="https://i.imgur.com/BiiApQ3.jpg" style="width:500px" />
</li>
</ul>
</li>
</ul>
<h3 id="knuth-morris-pratt-kmp"><a class="markdownIt-Anchor" href="#knuth-morris-pratt-kmp"></a> Knuth-Morris-Pratt (KMP)</h3>
<p>Use DFA to match the pattern in string in linear time.</p>
<h4 id="deterministic-finite-state-automaton-dfa"><a class="markdownIt-Anchor" href="#deterministic-finite-state-automaton-dfa"></a> Deterministic ﬁnite state automaton (DFA)</h4>
<ul>
<li>DFA is abstract string-searching machine.
<ul>
<li>
<img src="https://i.imgur.com/iQbPA0S.jpg" style="width:550px" />
</li>
<li>
<p><strong>State</strong> = number of characters in pattern that have been matched.</p>
<ul>
<li>e.g. 3 means 3 chars have been matcheed, aka <code>A B A</code>.</li>
</ul>
</li>
<li>
<p>EXACTLY one state <strong>transition</strong> for each char to another in alphabet from left to right.</p>
</li>
<li>
<p>When mismatch, the state will go back to the state that has the maximum matches so far.</p>
<ul>
<li>e.g. state 5. if follow by B, the state will go to 4, because <code>ABABAB</code> still has the <code>ABAB</code> matches which is state 4.</li>
</ul>
</li>
<li>
<p>Java code for search the pattern:</p>
<ul>
<li>
<img src="https://i.imgur.com/6vrBVW6.jpg" style="width:550px" />
</li>
<li>In the loop, we only augment i, and keep updating j until either i = N or j = M.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="how-to-build-dfa-from-pattern"><a class="markdownIt-Anchor" href="#how-to-build-dfa-from-pattern"></a> How to build DFA from pattern?</h4>
<ul>
<li>
<img src="https://i.imgur.com/2UAcaAu.jpg" style="width:600px" />
</li>
<li>
<img src="https://i.imgur.com/ZnczNtP.jpg" style="width:600px" />
<ul>
<li>State <strong>X</strong> is used for simulating when state <strong>j</strong> goes mismatch. Why?
<ul>
<li>For example, when j=5, we have matched pattern: <code>ABABA</code>. If the next char is not <code>C</code>, we have a mismatch. Then we need to match <code>BABA</code> (without the start A) in the existing previous pattern.
<ul>
<li>Why omit the first <code>A</code>? Think about how we do brute-force. after a mismatch, we restart the match with i+1. the same idea here.</li>
</ul>
</li>
<li>The straightforward way is to run a loop to rematch BABA then deciding where the new mismatch char should go. But a genious way is to mark a state <code>X</code> in the previous path so every time we only need to check how the last char(j) goes in the <code>X</code> state for mismatching.
<ul>
<li>Take 5 as an example. we can simply tell where a mismatch goes by simulating <code>3</code> because <code>BABA</code> ends with matching 3 elements(As showed in the graph). We only need to check where the state will go for a mismatch and copy over the mismatch to state 5.</li>
</ul>
</li>
<li>The next question is, how to find the state <code>X</code> without loop the whole [1,j-1] in the pattern?
<ul>
<li>Think about how to get X for state 5? We simulate <code>BABA</code> then check the mismatch of that state column. So what about X for state 4? we need to simulate <code>BAB</code>, right?</li>
<li>You can see to simulate <code>BABA</code>, we need to check the state for <code>BAB</code> and check where <code>A</code> goes on that state. Same as <code>BAB</code>, we need to find the state for <code>BA</code> at first, then check where the <code>B</code> goes.</li>
<li>So if we reverse the process, state <code>B</code> can be used for checking mismatch for <code>BA</code>, state <code>BA</code> can be used for checking <code>BAB</code>, state <code>BAB</code> can be used for checking <code>BABA</code>. We don’t actually need to loop every element for searching <strong>X</strong> but record the state of the previous match, and check the new element in the state which will be our state <strong>X</strong> for the next state’s mismatch.</li>
</ul>
</li>
<li>Let’s loop from the beginning.
<ul>
<li>when j = 0, nothing need to be done, the only match is A, and the others are 0. So we initialize X = 0.</li>
<li>When j = 1, we copy over the mismatches from state 0(X=0) to state 1. And mark X = dfa[B][0] = 0 meaning we finished the matching of [B], the next state can use the result as X.</li>
<li>When j = 2, we copy over the state 0 to state 2 as well. Notice that the mismatch is base on state 2, not 0. So for state 2, we only copy B, C, etc…, then set X = dfa[A][0] = 1 because after matching [BA] the state reached 1</li>
<li>When j = 3, we need to know what a match of [1, 2] looks like. [1, 2] = [BA] which already been set up in the last loop which X = 1. So we only need to copy over state 1 to 3, and then find the new X. X = state of [BAB] = dfa[B][1] = 2</li>
<li>When j = 4, same as last loop. Copy over, and set up X = state of [BABA] = dfa[A][2] = 3</li>
<li>Whey j = 5, copy over, and set up X = state of [BABAC] = dfa[C][3] = 0
<ul>
<li>
<img src="https://i.imgur.com/KtVYneb.jpg" style="width:400px" />
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Java implementation</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KMP</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String pat; </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[][] dfa;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KMP</span><span class="params">(String pat)</span> &#123;</span><br><span class="line">        <span class="comment">// Build DFA from pattern.</span></span><br><span class="line">        <span class="built_in">this</span>.pat = pat;</span><br><span class="line">        <span class="type">int</span> <span class="variable">M</span> <span class="operator">=</span> pat.length();</span><br><span class="line">        <span class="type">int</span> <span class="variable">R</span> <span class="operator">=</span> <span class="number">256</span>; <span class="comment">// ASCII, the graph only shows A, B and C, but it&#x27;s actually 256 characters</span></span><br><span class="line">        dfa = <span class="keyword">new</span> <span class="title class_">int</span>[R][M]; <span class="comment">// initialized with zeros as default</span></span><br><span class="line">        dfa[pat.charAt(<span class="number">0</span>)][<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">// only update the match case to 1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// then we start j at 1 since j = 0 already been initialized above</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">X</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">1</span>; j &lt; M; j++) &#123;</span><br><span class="line">            <span class="comment">// Compute dfa[][j].</span></span><br><span class="line">            <span class="comment">// Copy over all cases including mismatch cases.</span></span><br><span class="line">            <span class="comment">// when j = 1, the state X is dfa[1][0] = 0. so if there is a mismatch, it will return to state 0 which is A-&gt;1, B-&gt;0*, C-&gt;0.</span></span><br><span class="line">            <span class="comment">// notice we set up B to 0 in the loop, </span></span><br><span class="line">            <span class="comment">// it&#x27;s only for convenience, and will overwrite it later on.</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">0</span>; c &lt; R; c++)</span><br><span class="line">                dfa[c][j] = dfa[c][X]; </span><br><span class="line">            dfa[pat.charAt(j)][j] = j+<span class="number">1</span>; <span class="comment">// Overwrite the match case.</span></span><br><span class="line">            <span class="comment">// j = 1, pat.charAt(j) = B, X = 0, dfa[pat.charAt(j)][X] = 0;</span></span><br><span class="line">            <span class="comment">// j = 2, pat.charAt(j) = A, X = 0, dfa[pat.charAt(j)][X] = 1;</span></span><br><span class="line">            <span class="comment">// j = 3, pat.charAt(j) = B, X = 1, dfa[pat.charAt(j)][X] = 2;</span></span><br><span class="line">            <span class="comment">// j = 4, pat.charAt(j) = A, X = 2, dfa[pat.charAt(j)][X] = 3;</span></span><br><span class="line">            <span class="comment">// j = 5, pat.charAt(j) = C, X = 3, dfa[pat.charAt(j)][X] = 0;</span></span><br><span class="line">            <span class="comment">// j = 6, pat.charAt(j) = _, X = 0, dfa[pat.charAt(j)][X] = _;</span></span><br><span class="line">            <span class="comment">// The goal is to mark the match state of `[1, j]` in the current loop, </span></span><br><span class="line">            <span class="comment">// so we can fill out the mismatch for j+1 in the next loop,</span></span><br><span class="line">            <span class="comment">// because the mismatch of j+1 = the matching result of the state for [1-j].</span></span><br><span class="line">            X = dfa[pat.charAt(j)][X]; <span class="comment">// Update restart(X) state.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(String txt)</span> &#123; </span><br><span class="line">        <span class="comment">// Simulate operation of DFA on txt.</span></span><br><span class="line">        <span class="type">int</span> i, j, N = txt.length(), M = pat.length();</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; N &amp;&amp; j &lt; M; i++)</span><br><span class="line">            j = dfa[txt.charAt(i)][j];</span><br><span class="line">        <span class="keyword">if</span> (j == M) <span class="keyword">return</span> i - M; <span class="comment">// found (hit end of pattern)</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> N; <span class="comment">// not found (hit end of text)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Cost analysis</p>
<ul>
<li>KMP substring search accesses no more than <strong>M + N</strong> chars to search for a pattern of length M in a text of length N.</li>
</ul>
</li>
</ul>
<h3 id="boyer-moore"><a class="markdownIt-Anchor" href="#boyer-moore"></a> Boyer-Moore</h3>
<ul>
<li><strong>Intuition</strong>.
<ul>
<li>Scan characters in pattern from right to left.</li>
<li>Can skip as many as M text chars when finding one not in the pattern.</li>
<li>
<img src="https://i.imgur.com/VjXkKod.jpg" style="width:600px" />
</li>
</ul>
</li>
<li>How much to skip?
<ul>
<li><strong>Case 1.</strong> Mismatch character not in pattern.
<ul>
<li>mismatch character ‘T’ not in pattern: increment i one character beyond ‘T’ which measn i = j+1, j = length of the pattern.</li>
<li>
<img src="https://i.imgur.com/1VFgLt8.jpg" style="width:500px" />
</li>
</ul>
</li>
<li><strong>Case 2a.</strong> Mismatch character in pattern.
<ul>
<li>mismatch character ‘N’ in pattern: align text ‘N’ with <strong>rightmost</strong> pattern ‘N’.</li>
<li>
<img src="https://i.imgur.com/2VSMgxN.jpg" style="width:500px" />
</li>
<li>In the example above, <code>i = i + 3</code>. The comparing loop start from the right where <code>j = 5</code>. When mismatch, <code>j = 3</code> and the mismatched element <code>N</code>’s index = 0. So <code>i = i + (3 - 0)</code>.</li>
<li>So how to get 3?
<ul>
<li>First of all, we match text from right to left, as <code>j</code> is the index in the loop from <code>pattern.length-1</code> to <code>0</code>.</li>
<li>When the rightmost element didn’t match <code>text[i]</code>, but <code>text[i]</code> is still in the pattern, we will augment i by <code>j - (index of the matched element in the pattern)</code>.</li>
<li>If there are some repeated elements in the pattern, we will choose the rightmost one to avoid missing matches.
<ul>
<li>The refined equation becomes: <code>i = i + j - (index of the rightmost matched element in the pattern)</code>.</li>
</ul>
</li>
<li>There is another special case which will be demonstrated below:</li>
</ul>
</li>
</ul>
</li>
<li><strong>Case 2b.</strong> Mismatch character in pattern.
<ul>
<li>
<img src="https://i.imgur.com/GfnPQTz.jpg" style="width:500px" />
</li>
<li>You can see, if we align ‘E’ to the rightmost pattern ‘E’, the pattern will skip ‘-2’ since j = 3 and the index of E = 5.</li>
<li>So instead of skiping a nagative number, we increment i by 1.</li>
<li>Then the i-update becomes <code>i = i + Max(1, j - (index of the rightmost matched element in the pattern))</code>;</li>
</ul>
</li>
<li>To make the computation easier, we create a <code>right[]</code> to record the <code>(index of the rightmost matched element in the pattern)</code>:
<ul>
<li>Precompute index of rightmost occurrence of character <code>c</code> in pattern (<code>-1</code> if character not in pattern, meaning we skip <code>j-(-1) = j+1</code>).</li>
<li>
<img src="https://i.imgur.com/oaDW74R.jpg" style="width:600px" />
</li>
<li>You can see <code>E</code> occured three times, but we choose the rightmost one’s index as the one for calculation.
<ul>
<li>i.e. every time an <code>E</code> mismatch occurrs, backup <code>Max(1, 5-5) = 1</code> positions.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Java implementation
<ul>
<li>
<img src="https://i.imgur.com/5wbMyZN.jpg" style="width:500px" />
</li>
</ul>
</li>
<li>Worst-case. Can be as bad as ~ M N.
<ul>
<li>
<img src="https://i.imgur.com/yM0saDs.jpg" style="width:400px" />
</li>
</ul>
</li>
</ul>
<h3 id="rabin-karp"><a class="markdownIt-Anchor" href="#rabin-karp"></a> Rabin-Karp</h3>
<h4 id="basic-idea-modular-hashing"><a class="markdownIt-Anchor" href="#basic-idea-modular-hashing"></a> Basic idea = modular hashing</h4>
<ul>
<li>Compute a hash of pattern characters <code>0</code> to <code>M - 1</code>.</li>
<li>For each <code>i</code>, compute a hash of text characters <code>i</code> to <code>M + i - 1</code>.</li>
<li>If pattern hash = text substring hash, check for a match.</li>
<li>
<img src="https://i.imgur.com/qaOndBe.jpg" style="width:400px" />
</li>
</ul>
<h4 id="modular-hash-function"><a class="markdownIt-Anchor" href="#modular-hash-function"></a> Modular hash function</h4>
<ul>
<li>
<p>Using the notation <code>t_i</code> for <code>txt.charAt(i)</code>, we wish to compute</p>
<ul>
<li>
<img src="https://i.imgur.com/SoaS8eU.jpg" style="width:320px" />
</li>
</ul>
</li>
<li>
<p><strong>Horner’s method</strong>. Linear-time method to evaluate degree-M polynomial.</p>
<ul>
<li>
<img src="https://i.imgur.com/xGWs0e2.jpg" style="width:600px" />
</li>
</ul>
</li>
<li>
<p><strong>Efficiently computing the hash function</strong></p>
<ul>
<li>Can update hash function in constant time!</li>
<li>
<img src="https://i.imgur.com/dSHqctb.jpg" style="width:450px" />
</li>
<li>
<img src="https://i.imgur.com/ft4sFke.jpg" style="width:450px" />
</li>
</ul>
</li>
<li>
<p>Java implementation</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabinKarp</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> patHash; <span class="comment">// pattern hash value</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> M; <span class="comment">// pattern length</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> Q; <span class="comment">// modulus</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> R; <span class="comment">// radix</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> RM; <span class="comment">// R^(M-1) % Q</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RabinKarp</span><span class="params">(String pat)</span> &#123; </span><br><span class="line">        M = pat.length(); </span><br><span class="line">        R = <span class="number">256</span>; </span><br><span class="line">        Q = longRandomPrime(); <span class="comment">// a large prime (but avoid overflow)</span></span><br><span class="line"></span><br><span class="line">        RM = <span class="number">1</span>; </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= M-<span class="number">1</span>; i++) <span class="comment">// precompute R M – 1 (mod Q)</span></span><br><span class="line">            RM = (R * RM) % Q; </span><br><span class="line">        patHash = hash(pat, M);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Compute hash for M-digit key</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> <span class="title function_">hash</span><span class="params">(String key, <span class="type">int</span> M)</span> &#123; </span><br><span class="line">        <span class="type">long</span> <span class="variable">h</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; M; j++)</span><br><span class="line">        h = (R * h + key.charAt(j)) % Q;</span><br><span class="line">        <span class="keyword">return</span> h;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check for hash collision using rolling hash function</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(String txt)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">N</span> <span class="operator">=</span> txt.length(); </span><br><span class="line">        <span class="type">int</span> <span class="variable">txtHash</span> <span class="operator">=</span> hash(txt, M); </span><br><span class="line">        <span class="keyword">if</span> (patHash == txtHash) <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> M; i &lt; N; i++) &#123;</span><br><span class="line">            txtHash = (txtHash + Q - RM*txt.charAt(i-M) % Q) % Q;</span><br><span class="line">            txtHash = (txtHash*R + txt.charAt(i)) % Q;</span><br><span class="line">            <span class="comment">//  handle hash collision</span></span><br><span class="line">            <span class="comment">// 1. **Monte Carlo version**. Return match if hash match. Runs in linear time.</span></span><br><span class="line">            <span class="comment">//    * It is possible return the wrong answer.</span></span><br><span class="line">            <span class="comment">// 2. **Las Vegas version**. Check for substring match if hash match; continue search if false collision.</span></span><br><span class="line">            <span class="comment">//    * Confidence about the answer, but worst case is **MN**.</span></span><br><span class="line">            <span class="keyword">if</span> (patHash == txtHash) <span class="keyword">return</span> i - M + <span class="number">1</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> N;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="summary"><a class="markdownIt-Anchor" href="#summary"></a> Summary</h3>
<ul>
<li>Cost of searching for an M-character pattern in an N-character text.</li>
<li>
<img src="https://i.imgur.com/F7XoNuo.jpg" style="width:600px" />
</li>
</ul>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">
  
  <div class="divider"></div>
</div>

  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>

      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
