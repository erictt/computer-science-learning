<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Eric&#39;s CS Notes
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">
    
    <!-- katex css -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" integrity="sha384-Juol1FqnotbkyZUT5Z7gUPjQ9gzlwCENvUZTpQBAPxtusdwFLRy382PSDx5UUJ4/" crossorigin="anonymous">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>ERIC&#39;S CS NOTES</span>
  </a>
</div>

    <div class="book-menu">
  <!--
## Introduction to Probability

* [Unit 1: Probability models and axioms](/introduction-to-probability/unit-1/index.html)
* [Unit 2: Conditioning and independence](/introduction-to-probability/unit-2/index.html)
* [Unit 3: Counting](/introduction-to-probability/unit-3/index.html)
* [Unit 4: Discrete random variables](/introduction-to-probability/unit-4/index.html)
* [Unit 5: Continuous random variables](/introduction-to-probability/unit-5/index.html)
* [Unit 6: Further topics on random variables](/introduction-to-probability/unit-6/index.html)
* [Unit 7: Bayesian inference](/introduction-to-probability/unit-7/index.html)
* [Unit 8: Limit theorems and classical statistics](/introduction-to-probability/unit-8/index.html)
* [Unit 9: Bernoulli and Poisson processes](/introduction-to-probability/unit-9/index.html)
* [Unit 10: Markov chains](/introduction-to-probability/unit-10/index.html)
-->
<!--
## Multivariable Calculus

* [Unit 1: Thinking about multivariable functions](/multivariable-calculus/unit-1/index.html)
* [Unit 2: Derivatives of multivariable functions](/multivariable-calculus/unit-2/index.html)

* [Unit 3: Applications of multivariable derivatives](/multivariable-calculus/unit-3/index.html)
* [Unit 4: Integrating multivariable functions](/multivariable-calculus/unit-4/index.html)
* [Unit 5: Green's, Stokes', and the divergence theorems](/multivariable-calculus/unit-5/index.html)
-->
<h2 id="CS6210-Advanced-Operating-Systems">CS6210: Advanced Operating Systems</h2>
<ul>
<li><a href="/cs6210/lesson-02/index.html">Lesson 02: OS Structure</a></li>
<li><a href="/cs6210/lesson-03/index.html">Lesson 3: Virtualization</a></li>
<li><a href="/cs6210/lesson-04-1/index.html">Lesson 4: Parallel Systems - Part 1</a></li>
<li><a href="/cs6210/lesson-04-2/index.html">Lesson 4: Parallel Systems - Part 2</a></li>
<li><a href="/cs6210/lesson-05/index.html">Lesson 5: Distributed Systems</a></li>
<li><a href="/cs6210/lesson-06/index.html">Lesson 6: Distributed Objects and Middleware</a></li>
<li><a href="/cs6210/lesson-07/index.html">Lesson 7: Distributed Subsystems</a></li>
</ul>
<!--
* [Lesson 9: Internet Computing](/cs6210/lesson-09/index.html)
* [Lesson 10: RT and Multimedia](/cs6210/lesson-10/index.html)
* [Lesson 8: Failures and Recovery](/cs6210/lesson-08/index.html)
* [Lesson 11: Security](/cs6210/lesson-11/index.html)
-->
<h2 id="CS6250-Computer-Networks">CS6250 Computer Networks</h2>
<ul>
<li><a href="/cs6250/week-1-internet-architecture/index.html">Week 1 - Internet Architecture</a></li>
<li><a href="/cs6250/week-2-transport-and-application-layers/index.html">Week 2 - Transport and Application Layers</a></li>
<li><a href="/cs6250/week-3-intradomain-routing/index.html">Week 3 - Intradomain Routing</a></li>
<li><a href="/cs6250/week-4-as-relationships-and-interdomain-routing/index.html">Week 4 - AS Relationships and Interdomain Routing</a></li>
<li><a href="/cs6250/week-5-router-design-and-algorithems-part-1/index.html">Week 5 - Router Design and Algorithms (Part 1)</a></li>
<li><a href="/cs6250/week-6-router-design-and-algorithems-part-2/index.html">Week 6 - Router Design and Algorithms (Part 2)</a></li>
<li><a href="/cs6250/week-7-software-defined-networking-part-1/index.html">Week 7 - Software Defined Networking (Part 1)</a></li>
<li><a href="/cs6250/week-8-software-defined-networking-part-2/index.html">Week 8 - Software Defined Networking (Part 2)</a></li>
<li><a href="/cs6250/week-9-internet-security/index.html">Week 9 - Internet Security</a></li>
<li><a href="/cs6250/week-10-internet-surveillance-and-censorship/index.html">Week 10 - Internet Surveillance and Censorship</a></li>
<li><a href="/cs6250/week-11-applications-video/index.html">Week 11 - Applications Videos</a></li>
<li><a href="/cs6250/week-12-applications-cdns-and-overlay-networks/index.html">Week 12 - Applications CDNs and Overlay Networks</a></li>
</ul>
<h2 id="CS6200-Graduate-Introduction-to-Operating-Systems">CS6200 Graduate Introduction to Operating Systems</h2>
<ul>
<li><a href="/cs6200/p1-preparation/index.html">P0 - Preparation</a></li>
<li><a href="/cs6200/p1l2-introduction/index.html">P1L2 - Introduction</a></li>
<li><a href="/cs6200/p2l1-processes-and-process-management/index.html">P2L1 - Processes and Process Management</a></li>
<li><a href="/cs6200/p2l2-threads-and-concurrency/index.html">P2L2 - Threads and Concurrency</a></li>
<li><a href="/cs6200/p2l3-pthread/index.html">P2L3 - PThread</a></li>
<li><a href="/cs6200/p2l4-thread-design-consideration/index.html">P2L4 - Thread Design Considerations</a></li>
<li><a href="/cs6200/p2l5-thread-performance-consideration/index.html">P2L5 - Thread Performance Considerations</a></li>
<li><a href="/cs6200/p3l1-scheduling/index.html">P3L1 - Scheduling</a></li>
<li><a href="/cs6200/p3l2-memory-management/index.html">P3L2 - Memory Management</a></li>
<li><a href="/cs6200/p3l3-inter-process-communication/index.html">P3L3 - Inter-Process Communication</a></li>
<li><a href="/cs6200/p3l4-synchronization-constructs/index.html">P3L4 - Synchronization Constructs</a></li>
<li><a href="/cs6200/p3l5-io-management/index.html">P3L5 - I/O Management</a></li>
<li><a href="/cs6200/p3l6-virtualization/index.html">P3L6 - Virtualization</a></li>
</ul>
<!--
* [P4L1 - Remote Procedure Calls](/cs6200/p4l1-remote-procedure-calls/index.html) 
* [P4L2 - Distributed File Systems](/cs6200/p4l2-distributed-file-systems/index.html) 
* [P4L3 - Distributed Shared Memory](/cs6200/p4l3-distributed-shared-memory/index.html) 
* [P4L4 - Datacenter Technologies](/cs6200/p4l4-datacenter-technologies/index.html) 
-->
<h2 id="Algorithms-Part-II">Algorithms: Part II</h2>
<ul>
<li><a href="/algorithms-2/week-1/index.html">Week 1 - Undirected Graph &amp; Directed Graph</a></li>
<li><a href="/algorithms-2/week-2/index.html">Week 2 - Minimum Spanning Trees &amp; Shortest Path</a></li>
<li><a href="/algorithms-2/week-3/index.html">Week 3 - Maximum Flow and Minimum Cut &amp; String Sort</a></li>
<li><a href="/algorithms-2/week-4/index.html">Week 4 - Tries &amp; Substring Search</a></li>
<li><a href="/algorithms-2/week-5/index.html">Week 5 - Regular Expressions</a></li>
<li><a href="/algorithms-2/week-6/index.html">Week 6 - Reductions</a></li>
</ul>
<h2 id="Algorithms-Part-I">Algorithms: Part I</h2>
<ul>
<li><a href="/algorithms-1/week-1/index.html">Week 1 - Union-Find &amp; Analysis of Algorithms</a></li>
<li><a href="/algorithms-1/week-2/index.html">Week 2 - Stacks and Queues &amp; Elementary Sorts</a></li>
<li><a href="/algorithms-1/week-3/index.html">Week 3 - Mergesort &amp; Quicksort</a></li>
<li><a href="/algorithms-1/week-4/index.html">Week 4 - Priority Queues &amp; Elementary Symbols</a></li>
<li><a href="/algorithms-1/week-5/index.html">Week 5 - Balanced Search Trees</a></li>
<li><a href="/algorithms-1/week-6/index.html">Week 6 - Hash Tables</a></li>
</ul>
<h2 id="Introduction-to-Software-Design-and-Architecture">Introduction to Software Design and Architecture</h2>
<ul>
<li><a href="/introduction-to-software-design-and-architecture/design-pattern/index.html">Design Pattern</a></li>
</ul>
<h2 id="Calculus-Two-Sequences-and-Series">Calculus Two: Sequences and Series</h2>
<ul>
<li><a href="/calculus-two/week-1/index.html">Week 1 - Sequences</a></li>
<li><a href="/calculus-two/week-2/index.html">Week 2 - Series</a></li>
<li><a href="/calculus-two/week-3/index.html">Week 3 - Convergence Tests</a></li>
<li><a href="/calculus-two/week-4/index.html">Week 4 - Alternating Series</a></li>
<li><a href="/calculus-two/week-5/index.html">Week 5 - Power Series</a></li>
<li><a href="/calculus-two/week-6/index.html">Week 6 - Taylor Series</a></li>
</ul>
<h2 id="LAFF-Linear-Algebra">LAFF Linear Algebra</h2>
<ul>
<li><a href="/laff-linear-algebra/week-1/index.html">Week 1 - Vectors in Linear Algebra</a></li>
<li><a href="/laff-linear-algebra/week-2/index.html">Week 2 - Linear Transformations and Matrices</a></li>
<li><a href="/laff-linear-algebra/week-3/index.html">Week 3 - Matrix-Vector Operations</a></li>
<li><a href="/laff-linear-algebra/week-4/index.html">Week 4 - Matrix-Vector to Matrix-Matrix Multiplication</a></li>
<li><a href="/laff-linear-algebra/week-5/index.html">Week 5 - Matrix- Matrix Multiplication</a></li>
<li><a href="/laff-linear-algebra/week-6/index.html">Week 6 - Gaussian Elimination</a></li>
<li><a href="/laff-linear-algebra/week-7/index.html">Week 7 - More Gaussian Elimination and Matrix Inversion</a></li>
<li><a href="/laff-linear-algebra/week-8/index.html">Week 8 - More on Matrix Inversion</a></li>
<li><a href="/laff-linear-algebra/week-9/index.html">Week 9 - Vector Spaces</a></li>
<li><a href="/laff-linear-algebra/week-10/index.html">Week 10 - Vector Spaces, Orthogonality, and Linear Least-Squares</a></li>
<li><a href="/laff-linear-algebra/week-11/index.html">Week 11 - Orthogonal Projection, Low Rank Approximation, and Orthogonal Bases</a></li>
<li><a href="/laff-linear-algebra/week-12/index.html">Week 12 - Eigenvalues and Eigenvectors</a></li>
</ul>
<h2 id="Stanford-Machine-Learning">Stanford Machine Learning</h2>
<ul>
<li><a href="/stanford-machine-learning/week-1/index.html">Week 1 - Introduction</a></li>
<li><a href="/stanford-machine-learning/week-2/index.html">Week 2 - Linear Regression with Multiple Variables</a></li>
<li><a href="/stanford-machine-learning/week-3/index.html">Week 3 - Logistic Regression &amp; Regularization</a></li>
<li><a href="/stanford-machine-learning/week-4/index.html">Week 4 - Neural Networks: Representation</a></li>
<li><a href="/stanford-machine-learning/week-5/index.html">Week 5 - Neural Networks: Learning</a></li>
<li><a href="/stanford-machine-learning/week-6a/index.html">Week 6a - Advice for Applying Machine Learning</a></li>
<li><a href="/stanford-machine-learning/week-6b/index.html">Week 6b - Machine Learning System Design</a></li>
<li><a href="/stanford-machine-learning/week-7/index.html">Week 7 - Support Vector Machines</a></li>
<li><a href="/stanford-machine-learning/week-8/index.html">Week 8 - Unsupervised Learning &amp; Dimensionality Reduction</a></li>
<li><a href="/stanford-machine-learning/week-9a/index.html">Week 9a - Anomaly Detection</a></li>
<li><a href="/stanford-machine-learning/week-9b/index.html">Week 9b - Recommender Systems</a></li>
<li><a href="/stanford-machine-learning/week-10/index.html">Week 10 - Large Scale Machine Learning</a></li>
<li><a href="/stanford-machine-learning/week-11/index.html">Week 11 - Application Example: Photo OCR</a></li>
</ul>
<h2 id="Calculus-One">Calculus One</h2>
<ul>
<li><a href="/calculus-one/week-2-3/index.html">Week 2-3 - Functions &amp; Limits</a></li>
<li><a href="/calculus-one/week-4/index.html">Week 4 - The Beginning of Derivatives</a></li>
<li><a href="/calculus-one/week-5/index.html">Week 5 - Techniques of Differentiation</a></li>
<li><a href="/calculus-one/week-6/index.html">Week 6 - Chain Rule</a></li>
<li><a href="/calculus-one/week-7/index.html">Week 7 - Derivatives of Trigonometric Functions</a></li>
<li><a href="/calculus-one/week-8/index.html">Week 8 - Derivatives in the Real World</a></li>
<li><a href="/calculus-one/week-9/index.html">Week 9 - Optimization</a></li>
<li><a href="/calculus-one/week-10/index.html">Week 10 - Linear Approximation</a></li>
<li><a href="/calculus-one/week-11-12/index.html">Week 11-12 - Antidifferentiation &amp; Integration</a></li>
<li><a href="/calculus-one/week-13/index.html">Week 13 - Fundamental Theorem of Calculus</a></li>
<li><a href="/calculus-one/week-14/index.html">Week 14 - Substitution Rule</a></li>
<li><a href="/calculus-one/week-15/index.html">Week 15 - Techniques of Integration</a></li>
<li><a href="/calculus-one/week-16/index.html">Week 16 - Applications of Integration</a></li>
</ul>
<h2 id="Computational-Thinking">Computational Thinking</h2>
<ul>
<li><a href="/computational-thinking/lecture-1/index.html">Lecture 1 - Optimization and Knapsack Problem</a></li>
<li><a href="/computational-thinking/lecture-2/index.html">Lecture 2 - Decision Trees and Dynamic Programming</a>
<ul>
<li><a href="/computational-thinking/lecture-2-powerset/index.html">Exercise: Power Set Function</a></li>
</ul>
</li>
<li><a href="/computational-thinking/lecture-3/index.html">Lecture 3 - Graphs</a></li>
<li><a href="/computational-thinking/lecture-4-5/index.html">Lecture 4-5 - Plotting</a></li>
<li><a href="/computational-thinking/lecture-6-7/index.html">Lecture 6-7 - Stochastic Programs &amp; Inferential Statistics</a></li>
<li><a href="/computational-thinking/lecture-8/index.html">Lecture 8 - Monte Carlo Simulation</a></li>
<li><a href="/computational-thinking/lecture-9/index.html">Lecture 9 - Sampling and Standard Error</a></li>
<li><a href="/computational-thinking/lecture-10-11/index.html">Lecture 10-11 - Experimental Data</a></li>
<li><a href="/computational-thinking/lecture-12/index.html">Lecture 12 - Machine Learning</a></li>
<li><a href="/computational-thinking/lecture-13/index.html">Lecture 13 - Statistical Abuses</a></li>
</ul>
<h2 id="Effective-Thinking-Through-Mathematics">Effective Thinking Through Mathematics</h2>
<ul>
<li><a href="/effective-thinking-through-mathematics/note/index.html">Note</a></li>
<li><a href="/effective-thinking-through-mathematics/week-4-telling-the-story-of-infinity/index.html">Week 4 (/Telling the Story of Infinity)</a></li>
<li><a href="/effective-thinking-through-mathematics/week-5-telling-the-story-of-the-euler-circuit-theorem/index.html">Week 5 (/Telling the Story of Euler Circuit Theorem)</a></li>
</ul>
<h2 id="CS50-Introduction-to-Computer-Science">CS50 Introduction to Computer Science</h2>
<ul>
<li><a href="/cs50/week-1/index.html">Week 1 - C</a></li>
<li><a href="/cs50/week-2/index.html">Week 2 - Arrays</a></li>
<li><a href="/cs50/week-3/index.html">Week 3 - Algorithms</a></li>
<li><a href="/cs50/week-4/index.html">Week 4 - Memory</a></li>
<li><a href="/cs50/week-5/index.html">Week 5 - Data Structures</a></li>
<li><a href="/cs50/week-6/index.html">Week 6 - HTTP</a></li>
<li><a href="/cs50/week-7-10/index.html">Week 7-10 - Machine Learning/Python/SQL/Javascript</a></li>
</ul>
<h2 id="Others">Others</h2>
<ul>
<li><a href="/symbols/index.html">Symbols of Mathematics</a></li>
<li><a href="/glossary/index.html">Glossary</a></li>
</ul>
<h2 id="About-Me"><a target="_blank" rel="noopener" href="https://ericyy.me/about/">About Me</a></h2>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')  
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h1>Week 9 - Internet Security</h1>
<!-- toc -->
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#properties-of-secure-communication">Properties of Secure Communication</a></li>
<li><a href="#dns-abuse">DNS Abuse</a></li>
<li><a href="#how-to-infer-network-reputation">How to Infer Network Reputation</a>
<ul>
<li><a href="#evidence-of-abuse">Evidence of Abuse</a></li>
<li><a href="#interconnection-patterns">Interconnection Patterns</a></li>
<li><a href="#likelihood-of-breach">Likelihood of Breach</a></li>
</ul>
</li>
<li><a href="#traffic-attraction-attacks">Traffic Attraction Attacks</a>
<ul>
<li><a href="#bgp-hijacking">BGP Hijacking</a></li>
<li><a href="#motivations">Motivations</a></li>
<li><a href="#example-bgp-hijack-attacks">Example BGP Hijack Attacks</a></li>
<li><a href="#defending-against-bgp-hijacking">Defending against BGP Hijacking</a>
<ul>
<li><a href="#an-example-detection-system">An example detection system</a></li>
<li><a href="#example-mitigation-techniques">Example Mitigation Techniques</a></li>
</ul>
</li>
<li><a href="#optional-interact-with-a-bgp-prefix-hijacking-detection-system">Optional: Interact with a BGP prefix hijacking detection system</a></li>
<li><a href="#optional-reading-a-hijacking-case-study-background">Optional Reading: A Hijacking Case Study - Background</a></li>
<li><a href="#optional-reading-a-hijacking-case-study-attack-progression">Optional Reading: A Hijacking Case Study - Attack Progression</a></li>
</ul>
</li>
<li><a href="#ddos">DDoS</a>
<ul>
<li><a href="#background-and-spoofing">Background and Spoofing</a></li>
<li><a href="#reflection-and-amplification-attacks">Reflection and amplification attacks</a></li>
<li><a href="#defenses-against-ddos-attacks">Defenses Against DDoS Attacks</a></li>
<li><a href="#ddos-mitigation-techniques">DDoS Mitigation Techniques</a>
<ul>
<li><a href="#bgp-blackholing">BGP Blackholing</a></li>
<li><a href="#bgp-blackholing-limitations-and-problems">BGP Blackholing Limitations and Problems</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<!-- tocstop -->
<hr>
<h2 id="Introduction">Introduction</h2>
<p>In this lecture, we focus on</p>
<ul>
<li>Attacks that misuse the DNS protocol and the DNS infrastructure.</li>
<li>Traffic attraction attacks that are based on BGP abuse.</li>
<li>The most popular techniques to infer network reputation.</li>
<li>Denial of Service attacks.</li>
<li>The development of recent DDoS defenses techniques that are offered at IXPs.</li>
</ul>
<h2 id="Properties-of-Secure-Communication">Properties of Secure Communication</h2>
<ol>
<li>Confidentiality – Ensure that the message that is sent from the sender to the receiver is only available to the two parties. One measure to increase the chances that a communication is confidential is to encrypt the message so that even if the communication is intercepted, the message would be meaningless to the attacker.</li>
<li>Integrity – Ensure the message has not been somehow modified while in transit from the sender to the receiver. As a countermeasure, we can introduce mechanisms that check for the integrity of the message.</li>
<li>Authentication – When two parties are communicating, it is important to <em>ensure that the two parties are who they say they are</em>[Quiz].</li>
<li>Availability - A communication is not useful unless the information (or the service that is provided) is indeed available. So we will need to ensure that multiple aspects of the communication channel are functioning appropriately and we can cope with possible failures such as power outages, hardware failures, etc. or attacks that aim to render the system unavailable such as denial of service attacks.</li>
</ol>
<h2 id="DNS-Abuse">DNS Abuse</h2>
<p>Legitimate DNS-based techniques that legitimate businesses and administrators use:</p>
<p><strong>Round Robin DNS (RRDNS)</strong></p>
<p>This method is used by large websites to distribute the load of incoming requests to several servers at a <strong>single physical location</strong>[Quiz]. It responds to a DNS request with a list of DNS A records, which it then cycles through in a round robin manner. The DNS client can then choose a record using different strategies –choose the first record each time, use the closest record in terms of network proximity, etc. Each A record also has a Time to Live (TTL) for this mapping which specifies the number of seconds the response is valid. If the lookup is repeated while the mapping is still active, the DNS client will receive the same set of records, albeit in a different order.</p>
<p><strong>DNS-based content delivery</strong></p>
<p>Content Distribution Networks (CDNs) also use DNS-based techniques to distribute content but using more complex strategies. For example CDNs distribute the load amongst multiple servers at a single location, but also distribute these servers across the world[Quiz]. When accessing the name of the service using DNS, the CDN computes the ‘nearest edge server’ and returns its IP address to the DNS client. It uses sophisticated techniques based on network topology and current link characteristics to determine the nearest server. This results in the content being moved ‘closer’ to the DNS client which increases responsiveness and availability[Quiz]. CDNs can react quickly to changes in link characteristics as their TTL is lower than that in RRDNS.</p>
<p><strong>Fast-Flux Service Networks</strong></p>
<p>The previous two strategies provide reliability, scalability and resilience, which is great for larger websites. However, this also benefits spammers. Since using these techniques, a DNS request receives multiple A records (each containing a different IP address), this makes it <em>harder to shut down online scams, as if even one IP address is functional, the scam is still working</em>. Similarly, spreading across several servers makes the shutdown of these scams more complex!</p>
<ul>
<li>The attackers tend to keep the uptime of domains used for malicious purposes as long as possible[Quiz]</li>
</ul>
<p>Fast-Flux Service Networks (FFSN) is an extension of the ideas behind RRDNS and CDN. As its name suggests, it is based on a ‘rapid’ change in DNS answers, with a TTL lower than that of RRDNS and CDN. One key difference between FFSN and the other methods is that after the TTL expires, it returns a different set of A records from a larger set of compromised machines. These compromised machines act as proxies between the incoming request and control node/mothership, forming a resilient, robust, one-hop overlay network.</p>
<img src="https://i.imgur.com/AnGlDcH.png" style="width: 600px" />
<p>The figure above shows the content retrieval process of a benign HTTP server. The DNS lookup returns the IP address of the control node of that domain, and the request – HTTP GET is sent to this control node. The control node responds directly to the incoming request with the content of the domain.</p>
<img src="https://i.imgur.com/UxS1LJv.png" style="width: 600px" />
<p>The figure above shows the content-retrieval process for content hosted in a FFSN. The domain ‘<a target="_blank" rel="noopener" href="http://www.thearmynext.info">www.thearmynext.info</a>’ was found in a spam email. Here, the mothership is the control node where the actual content of the scam is being hosted. The DNS lookup from the client returns several different IP addresses, all belonging to compromised machines in the network (flux agents). Each time the TTL expires, the lookup returns completely different IP addresses. The flux-agent then relays the request it receives (HTTP GET) to the control node, which sends content to the flux-agent. Lastly, the content is delivered to the client. It is interesting to note that these flux agents, although seemingly close to each other, are usually located in different countries and belong to different Autonomous Systems (AS).</p>
<p>An important aspect of Internet abuse is the infrastructure that attackers use to support the abuse. For example, the attackers need Internet infrastructure to support illegal content hosting, C&amp;C infrastructure hosting, etc.</p>
<p>Next we will talk about approaches that have been suggested to infer network reputation, and hence the likelihood that a network will be abused to facilitate attacks.</p>
<h2 id="How-to-Infer-Network-Reputation">How to Infer Network Reputation</h2>
<h3 id="Evidence-of-Abuse">Evidence of Abuse</h3>
<p>In this section, we discuss FIRE – <em>FInding Rogue nEtworks</em>, a system that monitors the Internet for rogue networks. Rogue networks are networks whose main purpose is malicious activity such as phishing, hosting spam pages, hosting pirated software, etc. It uses three main data sources to identify hosts that likely belong to rogue networks:</p>
<ol>
<li><strong>Botnet command and control providers</strong>
<ul>
<li>Several botnets still rely on centralized command and control (C&amp;C). So a bot-master would prefer to host their C&amp;C on networks where it is unlikely to be taken down. The two main types of botnets this system considers are IRC-based botnets and HTTP-based botnets.</li>
</ul>
</li>
<li><strong>Drive-by-download hosting providers</strong>
<ul>
<li>Drive-by-download is a method of malware installation without interaction with the user. It commonly occurs when the victim visits a web page that contains an exploit for their vulnerable browser.</li>
</ul>
</li>
<li><strong>Phish housing providers</strong>
<ul>
<li>This data source contains URLs of servers that host phishing pages. Phishing pages usually mimic authentic sites to steal login credentials, credit card numbers and other personal information. These pages are hosted on compromised servers and usually are up only for a short period of time.</li>
</ul>
</li>
</ol>
<p><u>The key difference between rogue and legitimate networks is the <strong>longevity(persistence) of malicious behavior</strong></u>[Quiz]. <u><strong>Legitimate networks</strong> are usually able to remove the malicious content <strong>within a few days</strong> whereas <strong>rogue networks</strong> may let the content be <strong>up for weeks to more than a year</strong>[Quiz]</u>! By disregarding IP addresses that have been active for a short time, we ignore phishing attacks hosted on legitimate networks and web servers that were temporarily abused for botnet communication.</p>
<p>Each of these data sources produces <em>a list (Li) of malicious IP addresses</em> daily. <u>FIRE combines the information from these three lists to identify rogue AS (organizations are considered equivalent to autonomous systems). The approach is to identify the most malicious networks as those which have <strong>the highest ratio of malicious IP addresses as compared to the total owned IP addresses of that AS</strong>.</u>[Quiz]</p>
<h3 id="Interconnection-Patterns">Interconnection Patterns</h3>
<p>In an earlier topic, we discussed an approach that is based on data plane monitoring. With data plane monitoring only if a network has a large enough concentration of blacklisted IPs it will be flagged as malicious. We flag a network as malicious only after we have observed indications of malicious behavior for a long enough period of time. For example, let’s say we have access to a blacklist and we observe a large number of IPs that belong to an AS to be blacklisted for spamming, phishing, hijacking, etc.</p>
<p>But in practice, it is not feasible to monitor the traffic of all networks to detect malicious behaviors from the data plane. In addition, the disadvantage of this approach is that 1) it may take a long time until a very large fraction of IPs makes it to a blacklist, and 2) the approach does not differentiate well between networks that are legitimate but abused, and those which are likely operated by cyberactors.</p>
<p>This topic discusses a complementary approach – <strong>ASwatch</strong> which uses information <strong>exclusively from the control plane (ie. routing behavior) to identify malicious networks</strong>[Quiz]. Also, this approach aims to detect malicious networks that are likely run by cyberactors, or bulletproof as they are called, rather than networks that may be badly abused.</p>
<p>The approach is based on the observation that bulletproof <u>ASes have distinct interconnection patterns and overall different control plane behavior from most legitimate networks.</u>[Quiz] For example, let’s observe example snapshots of the topology around known bulletproof networks, that are taken a few months apart.</p>
<img src="https://i.imgur.com/LiASfAh.png" style="width: 800px" />
<img src="https://i.imgur.com/tQ0KZXb.png" style="width: 800px" />
<img src="https://i.imgur.com/kUBDaxG.png" style="width: 800px" />
<p>These networks shown as red in the figures are found to be changing upstream providers more aggressively than most legitimate networks, also they are found to behave customer-provider or peering relationships with likely shady networks, rather than connecting with directly with legitimate networks. <strong>These behaviors help the bulletproof network to remain unnoticeable for longer</strong>, and <strong>when complaints may start, the bulletproof network can simply change an upstream provider</strong>.</p>
<p>The design of ASwatch is based on monitoring global BGP routing activity to learn the control plane behavior of a network. The system has two phases:</p>
<ol>
<li>
<p><strong>Training phase</strong> - The system learns control-plane behavior typical of both types of ASes. The system is given a list of known malicious and legitimate ASes. It then tracks the behavior of these ASes over time to track their business relationships with other ASes and their BGP updates/withdrawals patterns.  ASwatch then computes statistical features of each AS. There are three main families of features:</p>
<ol>
<li>Rewiring activity – <u>based on changes in the AS connecting activity</u>[Quiz]. Frequent changes in customers/providers, connecting with less popular providers, etc. is usually suspicious behavior.
<ul>
<li><u>So to remain undetected by ASwatch, a rogue network can maintain a stable control plane behavior.</u>[Quiz]</li>
</ul>
</li>
<li>IP Space Fragmentation and Churn - based on the advertised prefixes. Malicious ASes are likely to use small BGP prefixes to partition their IP address space and only advertise a small section of these (to avoid all of them being taken down at one if detected).</li>
<li>BGP Routing Dynamics – The BGP announcements and withdrawals for malicious ASes follow different patterns from legitimate ones – such as periodically announcing prefixes for short periods of time.<br>
The system then uses supervised learning to capture the known behaviors and patterns with a trained model.</li>
</ol>
</li>
<li>
<p><strong>Operational phase</strong> - Given an unknown AS, it then calculates the features for this AS. It uses the model to then assign a reputation score to the AS. If the system assigns the AS a low reputation score for several days in a row (indicating consistent suspicious behavior), it identifies it as malicious.</p>
</li>
</ol>
<h3 id="Likelihood-of-Breach">Likelihood of Breach</h3>
<p>In this section, we look at a system to predict the likelihood of a security breach within an organization (such as the JP Morgan Chase attack that affected almost 76 million households), by using only externally observable features. This is important, as it allows the model to be scalable to all organizations! The system uses these features to train a Random Forest and predict the likelihood.</p>
<p>There are 3 classes of features used for this model:</p>
<ol>
<li><strong>Mismanagement symptoms</strong> – If there are misconfigurations in an organization’s network, it indicates that there may not be policies in place to prevent such attacks or may not have the technological capability to detect these failures. This increases the likelihood of a breach. The features used are:
<ol>
<li>Open Recursive Resolvers – misconfigured open DNS resolvers</li>
<li>DNS Source Port Randomization – many servers still do not implement this</li>
<li>BGP Misconfiguration – short-lived routes can cause unnecessary updates to the global routing table</li>
<li>Untrusted HTTPS Certificates – can detect the validity of a certificate by TLS handshake</li>
<li>Open SMTP Mail Relays – servers should filter messages so that only those in the same domain can send mails/messages.</li>
</ol>
</li>
<li><strong>Malicious Activities</strong> – Another factor to consider is the level of malicious activities that are seen to originate from the organization’s network and infrastructure. We can determine this using spam traps, darknet monitors, DNS monitors, etc. We create a reputation blacklist of the IP addresses that are involved in some malicious activities. There are 3 such types of malicious activities:
<ol>
<li>Capturing spam activity – for example, CBL, SBL, SpamCop</li>
<li>Capturing phishing and malware activities – for example, PhishTank, SURBL</li>
<li>Capturing scanning activity – for example, Dshield, OpenBL</li>
</ol>
</li>
<li><strong>Security Incident Reports</strong> – Data based on actual security incidents gives us the ground truth on which to train our machine learning model on. The system uses 3 collections of such reports to ensure a wider coverage area:
<ol>
<li>VERIS Community Database – This is a public effort to collect cyber security incidents in a common format. It is maintained by the Verizon RISK team. It contains more than 5000 incident reports.</li>
<li>Hackmageddon – This is an independently maintained blog that aggregates security incidents on a monthly basis.</li>
<li>The Web Hacking Incidents Database – This is an actively maintained repository for cyber security incidents.</li>
</ol>
</li>
</ol>
<p>This system uses a Random Forest (RF) classifier and compares it to a baseline provided by a Support Vector Machine (SVM). It uses 258 features – the features described above (divided into features based on the timespan for which they are valid), secondary features based on statistics from the other features, and the size of the organization. These inputs are processed, then fed to a RF which produces a risk probability (a float). By thresholding this value, we obtain the binary class label. Since this data is sequential, the training-testing splits of the data are strictly based on the time of each datapoint. The best combination of parameters gives this model an accuracy of 90%!</p>
<h2 id="Traffic-Attraction-Attacks">Traffic Attraction Attacks</h2>
<h3 id="BGP-Hijacking">BGP Hijacking</h3>
<p><strong>BGP hijacking attacks</strong> can be classified into the following groups:</p>
<ol>
<li><strong>Classification by Affected Prefix</strong>: In this class of hijacking attacks, we are primarily concerned with the IP prefixes that are advertised by BGP. There are different ways the prefix can be targeted, such as:
<ol>
<li><strong>Exact prefix hijacking</strong>: When two different ASes (one is genuine and the other one is counterfeit) announce a path for the same prefix. This disrupts routing in such a way that traffic is routed towards the hijacker wherever the AS-path route is shortest, thereby disrupting traffic.</li>
<li><strong>Sub-prefix hijacking</strong>: This is an extension of exact prefix hijacking, except that in this case, the hijacking AS works with a sub-prefix of the genuine prefix of the real AS. <u>This exploits the characteristic of BGP to favor more specific prefixes</u>, and as a result route large/entire amount of traffic to the hijacking AS[Quiz].
<ul>
<li>Example: A given hijacking AS labelled AS2 announces that it has a path to prefix 10.10.0.0/24 which is a part of 10.10.0.0/16 owned by AS1.</li>
</ul>
</li>
<li><strong>Squatting</strong>: In this type of attack, the hijacking AS announces a prefix that has not yet been announced by the owner AS.</li>
</ol>
</li>
<li><strong>Classification by AS-Path announcement</strong>: In this class of attacks, an illegitimate AS announces the AS-path for a prefix for which it doesn’t have ownership rights. There are different ways this can be achieved:
<ol>
<li><strong>Type-0 hijacking</strong>: This is simply an AS announcing a prefix not owned by itself.</li>
<li><strong>Type-N hijacking</strong>: This is an attack where the counterfeit AS announces an illegitimate path for a prefix that it does not own to create a fake link (path) between different ASes.
<ul>
<li>For example, {AS2, ASx, ASy, AS1 – 10.0.0.0/23} denotes a fake path between AS2 and AS1, where there is no link between AS2 and ASx. The N denotes the position of the rightmost fake link in the illegitimate announcement, e.g. {AS2, ASy, AS1 – 10.0.0.0/23} is a Type-2 hijacking.</li>
</ul>
</li>
<li><strong>Type-U hijacking</strong>: In this attack the hijacking AS does not modify the AS-PATH but may change the prefix.</li>
</ol>
</li>
<li><strong>Classification by Data-Plane traffic manipulation</strong>: In this class of attacks, the intention of the attacker is to hijack the network traffic and  manipulate the redirected network traffic on its way to the receiving AS. There are three ways the attack can be realized under this classification, i.e.   traffic intercepted by the hijacker can be
<ol>
<li>Dropped, so that it never reaches the intended destination. This attack falls under the category of <strong>blackholing (BH) attack</strong>.</li>
<li>Eavesdropped or manipulated before it reaches the receiving AS, which is also called as <strong>man-in-the-middle attack (MM)</strong>.</li>
<li>Impersonated, e.g. In this case the network traffic of the victim AS is impersonated and the response to this network traffic is sent back to the sender. This attack is called <strong>imposture (IM) attack.</strong>
<ul>
<li>Note that these manipulation happen on the data plane[Quiz]</li>
</ul>
</li>
</ol>
</li>
</ol>
<h3 id="Motivations">Motivations</h3>
<p>In the previous section, we looked at the types of BGP hijacking attacks, and how to characterize them individually. In this section, we are interested in understanding the <strong>causes or motivations behind these attacks</strong>. Broadly viewed, the attacks can be classified as caused by:</p>
<ol>
<li><strong>Human Error</strong>: This is an accidental routing misconfiguration due to manual errors. This can lead to large scale exact-prefix hijacking. e.g: China Telecom accidentally leaked a full BGP table that led to large-scale Type-0 hijacking</li>
<li><strong>Targeted Attack</strong>: In this type of attack, the hijacking AS usually intercepts network traffic (MM attack) while operating in stealth mode to remain under the radar on the control plane (Type-N and Type-U attacks). e.g: Visa and Mastercard’s traffic were hijacked by Russian networks using this method in 2017</li>
<li><strong>High Impact Attack</strong>: Here, the attacker is obvious in their intent to cause widespread disruption of services. e.g: Pakistan Telecom in a Type-0 sub-prefix hijacking, essentially blackholing all of YouTube’s services worldwide for nearly 2 hours.</li>
</ol>
<p>To summarize, we can say that the motivation behind every hijacking attempt is different, so there is no one answer when it comes to choosing the best attack. Given the constraining scenario and intents of the hijacking attempt, the hijacker may employ one or a combination of methods to carry out the attack.</p>
<h3 id="Example-BGP-Hijack-Attacks">Example BGP Hijack Attacks</h3>
<p>We briefly looked at the different types of BGP hijacking attacks in the previous section. Let’s look at how these attacks are carried out through some examples.</p>
<p>Let’s first look at a legitimate scenario. In the figure below, we have a new prefix being announced by an AS to its neighbors:</p>
<ol>
<li>AS1 announces a new prefix (10.10.0.0/16)</li>
<li>AS2, AS3, AS4 and AS5 that receive an announcement from the previous / neighboring AS, check whether this entry is present in the RIB, if new, add it, and send it to all neighboring ASes.</li>
<li>As the announcements are made by AS2, AS3 and AS4; A5 eventually receives the full path and new prefix from A4 (4,2,1).</li>
<li>If multiple routes exist for a prefix, then the selected (best) route is highlighted. Also, this route is selected for announcement to the neighbors.</li>
</ol>
<img src="https://i.imgur.com/5fW4Qh6.png" style="width: 800px" />
<p><strong>Attack Scenario: Hijacking a prefix</strong></p>
<p>Let’s look at the scenario of prefix hijacking. In this scenario, the attacker uses a router at AS4 to send false announcements and hijack the prefix 10.10.0.0/16 that belongs to AS1.</p>
<ol>
<li>The attacker uses a router to announce the prefix 10.10.0.0/16 that belongs to AS1, with a new origin AS4, pretending that the prefix belongs to AS4.</li>
<li>This new announcement causes a conflict of origin for the ASes that receive it (Multiple Origin AS or MOAS).</li>
<li>As a result of the new announcement, AS2, AS3 and AS5 receive the false advertisement and they compare it with the previous entries in their RIB.</li>
<li>AS2 will not select the route as the best route as it has the same path length with an existing entry.</li>
<li>AS3 and AS5 will believe the new advertisement, and they will update their entries (10.10.0.0/16 with path 4,2,1) to (10.10.0.0/16 with path 4). Therefore AS5 and AS3 will send all traffic for prefix 10.10.0.0/16 to AS4 instead of AS1.</li>
</ol>
<img src="https://i.imgur.com/jz6NJ6b.png" style="width: 800px" />
<p><strong>Attack Scenario: Hijacking a path</strong></p>
<p>In the figure below we see an attack scenario where a legitimate path is hijacked.</p>
<img src="https://i.imgur.com/6fBwspd.png" style="width: 800px" />
<p>In this scenario, the attacker manipulates received updates before propagating them to neighbors.</p>
<ol>
<li>AS1 advertises the prefix 10.10.0.0/16.</li>
<li>AS2 and AS3 receive and propagate legitimately the path for the prefix.</li>
<li>At AS4, the attacker compromises the update for the path by changing it to 4,1 and propagates it to the neighbors AS3, AS2, and AS5. Therefore it claims that it has direct link to AS1 so that others believe the new false path.</li>
<li>AS5 receives the false path (4,1)  “believes” the new false path and it adopts it. But the rest of the ASes don’t adopt the new path because they either have a shorter path already or an equally long path to AS1 for the same prefix.</li>
</ol>
<p>The key observation here is that the attacker does not need to announce a new prefix, but rather it manipulates an advertisement before propagating it.</p>
<h3 id="Defending-against-BGP-Hijacking">Defending against BGP Hijacking</h3>
<h4 id="An-example-detection-system">An example detection system</h4>
<p>In this section we will look at some high level ideas behind detecting BGP hijacking. ARTEMIS is a system that is run locally by network operators to safeguard its own prefixes against malicious BGP hijacking attempts. The authors of the ARTEMIS paper (Sermpezis et al) describe a self-operated manner of prefix hijacking detection.</p>
<p>The key ideas behind ARTEMIS are[Quiz]:</p>
<ol>
<li><strong>A configuration file</strong>: where all the prefixes owned by the network are listed here for reference. This configuration file is populated by the network operator.</li>
<li><strong>A mechanism for receiving BGP updates</strong>: this allows receiving updates <strong>from local routers and monitoring services</strong>. This is built into the system</li>
</ol>
<p>Using the local configuration file as a reference, for the received BGP updates, ARTEMIS can check for prefixes and AS-PATH fields and trigger alerts when there are anomalies.</p>
<img src="https://i.imgur.com/0Mcnt1w.png" style="width: 800px" />
<p>A point of consideration in BGP hijacking detection is the performance of False Positive (FP) and False Negative (FN) rates when we use different detection criteria. We ideally want a system with the least number of FPs and FNs that are inconsequential. The ARTEMIS system also allows the network operator to choose between a) accuracy and speed, and b) FN which are inconsequential (less impact on control plane) for less FP.</p>
<h4 id="Example-Mitigation-Techniques">Example Mitigation Techniques</h4>
<p>For a system that protects against BGP hijacking attacks with less manual intervention, we need automated ways of mitigation from BGP hijacking attacks. The ARTEMIS system uses <u>two automated techniques in mitigating these attacks</u>[Quiz]:</p>
<ol>
<li><strong>Prefix deaggregation</strong>: In a BGP attack scenario, the affected network can either contact other networks or it can simply deaggregate the prefixes that were targeted by announcing more specific prefixes of a certain prefix. Remember our prior discussion of YouTube’s services being attacked by Pakistan Telecom. The targeted prefix was 208.65.153.0/24. Within 90 minutes, YouTube started announcing 208.65.153.128/25 and 208.65.153.0/25, thereby counteracting the attack. Although the event required a long term solution, an immediate mitigation was required for services to come back online.</li>
<li><strong>Mitigation with Multiple Origin AS (MOAS)</strong>: Here, the idea is to have third party organizations and service providers do BGP announcements for a given network. It is akin to the current model that exists for legitimizing network traffic by third parties that mitigate DDoS attacks. When a BGP hijacking event occurs, the following steps occur:
<ol>
<li>The third party receives a notification and immediately announces from their locations the hijacked prefix(es).</li>
<li>In this way, network traffic from across the world is attracted to the third party organization, which then scrubbs it and tunnels it to the legitimate AS.</li>
</ol>
</li>
</ol>
<p>The authors of the ARTEMIS paper put forth two main findings from their research  work:</p>
<ol>
<li><strong>Outsource the task of BGP announcement to third parties</strong>: To combat against BGP hijacking attacks, having even just one single external organization to mitigate BGP attacks is highly effective against BGP attacks.</li>
<li><strong>Comparison of outsourcing BGP announcements vs prefix filtering</strong>: When compared against prefix filtering, which is the current standard defense mechanism, the research work found that filtering is less optimal when compared against BGP announcements.</li>
</ol>
<h3 id="Optional-Interact-with-a-BGP-prefix-hijacking-detection-system">Optional: Interact with a BGP prefix hijacking detection system</h3>
<p>Optionally, you can download and interact with the ARTEMIS detection system we talked about in the previous topics. The link below provides a link to the demo of the system.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/FORTH-ICS-INSPIRE/artemis">https://github.com/FORTH-ICS-INSPIRE/artemis</a></li>
</ul>
<h3 id="Optional-Reading-A-Hijacking-Case-Study-Background">Optional Reading: A Hijacking Case Study - Background</h3>
<p>To get a better understanding of AS hijacking and its implications, let’s look at a real case study, known as the “Linktel Incident”.</p>
<ol>
<li>Linktel, a Russian ISP under attack (AS31733, figure below) sent a distress mail (SOS) to North American Network Operators’ Group (NANOG) about a prefix hijacking in August 2011.</li>
<li>The Russian ISP had gone through financial struggles, and thus had not renewed its DNS domain, which allowed administrative take-over of its Internet resources.</li>
<li>The attacker took over the Internet resources and forged a letter of authorization to announce prefixes of AS31733 from a customer’s AS (AS12182, figure below).</li>
<li>The attacker uses a second attack to hijack AS42461 (Relians Ltd., figure below) to announce an unallocated prefix.</li>
</ol>
<img src="https://i.imgur.com/rJVYnRq.png" style="width: 800px" />
<p>In the figure above, we see that Link Telecom (AS 31733) has Digital Networks JSC (AS 12695) as its provider. Linktel (AS 31733) has its allocated prefixes which are targeted by the attacker via Internap (AS 12182). The attacker starts with announcing one prefix, and takes over other prefixes over time. As indicated in the figure, some prefixes are not affected by the attack (unannounced).</p>
<p>To exploit an unallocated address space of Linktel, the attacker brings in another hijacked AS 42461 (that belongs to Relians Ltd), which is also being served by the same upstream provider as that of Linktel. The attacker uses this as a decoy channel to test announcing the unallocated address space (89.145.168.0/21) without affecting the whole attack.</p>
<h3 id="Optional-Reading-A-Hijacking-Case-Study-Attack-Progression">Optional Reading: A Hijacking Case Study - Attack Progression</h3>
<p>The Linktel incident ran its course for about 6 months, starting from the attack phase to the productive phase to the recovery phase. Let’s look at these phases</p>
<p><strong>Hijacking Phase</strong></p>
<ul>
<li>As mentioned in the previous section, the hijacking attempt was made possible by a vulnerability that could be exploited: in this case Linktel had let its DNS domain (link-telecom) expire, which consequently could be taken over by anyone and be used maliciously.</li>
<li>The attacker re-registered the domain within 6 hours of its expiration, and possibly evaluated attack scenarios and carried out a prefix announcement (188.164.0.0/16) a month later using another ISP Internap. A couple of weeks later, other prefixes that belonged to Linktel’s networks were slowly announced.</li>
<li>The attacker further explored announcing another address space (89.145.168.0/21) using another hijacked AS that belonged to Relians Ltd (AS42461)</li>
<li>Finally, a forged letter of authorization was issued to Internap, although at this point Internap had been announcing the attacker’s routes for two months without authorization</li>
</ul>
<p><strong>Productive Phase</strong></p>
<ul>
<li>In this phase, the attacker stopped announcing the unallocated prefix 89.145.168.0/21 which was used via the AS belonging to Relians Ltd.</li>
<li>Since the attacker’s motivation was to send spam, it was eventually caught by Spamhaus, and the prefixes were blacklisted although it took a considerable amount of time to detect spam operations</li>
</ul>
<p><strong>Recovery Phase</strong></p>
<ul>
<li>Linktel itself was recovering from a financial crisis, and in its attempt to bring its prefixes back online, it recognized that its prefixes had been blacklisted by Spamhaus.</li>
<li>Upon further digging, it found that Internap was announcing its prefixes and that it was authorized to do so (based on a forged letter of authorization from the attacker).</li>
<li>ventually, Linktel  complains to its upstream ISPs and redelegates reverse DNS entries and announces more specific prefixes. The upstream ISPs comply and withdraw routes from hijacked prefixes.</li>
</ul>
<img src="https://i.imgur.com/VNvTYyx.png" style="width: 800px" />
<img src="https://i.imgur.com/OCtyftZ.png" style="width: 800px" />
<img src="https://i.imgur.com/c6yCbUZ.png" style="width: 800px" />
<p>An analysis of traffic flows during the attack period add more insights.</p>
<p>Seen another way, in the figure below, we can plot a graph (Frequency of observed flows vs Date of hijacking event) for the three phases of the Linktel incident. The 603 traffic flows analyzed in the three phases show a correlation between the attack phases and flows originating from the hijacked prefixes.</p>
<p>Notably:</p>
<ol>
<li>The attacker’s first announcement was received on April 15, and the first related flow is observed on April 18, which is indicated by the first spike in the graph</li>
<li>A large amount of BGP withdraw messages are received on July 11 for the unallocated space</li>
<li>While Spamhaus blacklists the prefixes on July 28, it’s possible that it is due to two reasons: a) Spamhaus takes a long time to detect anomalies, and b) The attacker might’ve performed other activities apart from spamming</li>
</ol>
 <img src="https://i.imgur.com/bKzryxp.png" style="width: 800px" />
<h2 id="DDoS">DDoS</h2>
<h3 id="Background-and-Spoofing">Background and Spoofing</h3>
<p>In this topic, we are talking about another type of abuse; the <strong>Denial of Service Attack (DDoS)</strong>. We are also talking about how attackers amplify DDoS attacks by using an additional technique called <strong>Spoofing</strong>.</p>
<p>A Distributed Denial of Service (DDoS) attack is an attempt to compromise a server or network resources with a flood of traffic. To achieve this, the attacker first compromises and deploys flooding servers (slaves).</p>
<p>Later, when initiating an attack, the attacker instructs these flooding servers to send a high volume of traffic to the victim. This results in the victim host either becoming unreachable or in exhaustion of its bandwidth.</p>
<img src="https://i.imgur.com/AdLdcTp.png" style="width: 800px" />
<p>In the above figure, the master host, controlled by the attacker, sends control messages to the three compromised slaves directing them to send a huge amount of traffic to the victim. The packets sent from the slave contain the source address as a random IP address and the destination as the victim’s IP address. This master slave configuration amplifies the intensity of the attack while also making it difficult to protect against it. The attack traffic sent by the slaves contain spoofed source addresses making it difficult for the victim to track the slaves. Also, since the traffic is sent from multiple sources, it’s harder for the victim to isolate and block the attack traffic.</p>
<p><strong>Spoofing</strong>:</p>
<p>IP spoofing is the act of setting a false IP address in the source field of a packet with the purpose of impersonating a legitimate server. In DDoS attacks, this can happen in two forms. In the first form, <em>the source IP address is spoofed, resulting in the response of the server sent to some other client instead of the attacker’s machine.</em> This results in wastage of network resources and the client resources while also causing denial of service to legitimate users.</p>
<p>In the second type of attack, the attacker sets <em>the same IP address in both the source and destination IP fields</em>. This results in the server sending the replies to itself, causing it to crash.</p>
<h3 id="Reflection-and-amplification-attacks">Reflection and amplification attacks</h3>
<p>In a reflection attack, the attackers use a set of reflectors to initiate an attack on the victim. A reflector is any server that sends a response to a request. For example, any web server or a DNS server would return a SYN ACK in response to a SYN packet as part of TCP handshake. Other examples include query responses sent by a server or Host Unreachable responses to a particular IP.</p>
<ul>
<li><u>To detect DNS reflection and amplification attacks, you only need access to data plane data</u>[Quiz]!!</li>
<li><u>To detect BGP attacks(specially BGP path and prefix attacks), you only need access to control plane data</u>[Quiz]!!</li>
</ul>
<p>Here, the master directs the slaves to <em>send spoofed requests to a very large number of reflectors,</em> usually in the range of 1 million. The slaves <em>set the source address of the packets to the victim’s IP address</em>, thereby redirecting the response of the reflectors to the victim. Thus, the victim receives responses from millions of reflectors resulting in exhaustion of its bandwidth. In addition, the resources of the victim is wasted in processing these responses, making it unable to respond to legitimate requests. This forms the basis of a reflection attack. Let’s consider the below figure. (short rephrase: the attackers use a set of reflectors to initiate attacks to the victim instead of attacking it directly[Quiz])</p>
<img src="https://i.imgur.com/uo32ezF.png" style="width: 800px" />
<p>The master commands the three slaves to send spoofed requests to the reflectors, which in turn sends traffic to the victim. This is in contrast with the conventional DDoS attack we saw in the previous section, where the slaves directly send traffic to the victim. Note that the victim can easily identify the reflectors from the response packets. However, the reflector cannot identify the slave sending the spoofed requests.</p>
<p>If the requests are chosen in such a way that the reflectors send large responses to the victim, it is a reflection and amplification attack. Not only would the victim receive traffic from millions of servers, the response sent would be large in size, making it further difficult for the victim to handle it.</p>
<h3 id="Defenses-Against-DDoS-Attacks">Defenses Against DDoS Attacks</h3>
<p>In this topic we are providing an overview of the tools that we have to help with a DDoS attack is under the way or to help deter the attack.</p>
<p><strong>Traffic Scrubbing Services</strong></p>
<p>A scrubbing service diverts the incoming traffic to a specialized server, where the traffic is <u>“scrubbed” into either clean or unwanted traffic.</u> <u>The clean traffic is then sent to its original destination</u>[Quiz]. Although this method offers fine-grained filtering of the packets, there are monetary costs required for an in-time subscription, setup and other recurring costs. The other limitations include reduced effectiveness due to per packet processing and challenges in handling Tbps level attacks. There’s also a possibility of decreased performance as the traffic may be rerouted and becoming susceptible to evasion attacks.</p>
<p><strong>ACL Filters</strong></p>
<p>Access Control List filters are deployed by ISPs or IXPs at their AS border routers to filter out unwanted traffic. These filters, whose implementation depends on the vendor-specific hardware, are effective when the hardware is homogeneous and the deployment of the filters can be automated. The drawbacks of these filters include limited scalability and since the filtering does not occur at the ingress points, it can exhaust the bandwidth to a neighboring AS.</p>
<p><strong>BGP Flowspec</strong></p>
<p>The flow specification feature of BGP, called Flowspec, helps to mitigate DDoS attacks by supporting the deployment and propagation of <u>fine-grained filters across AS domain borders</u>[Quiz]. It can be designed to <strong>match a specific flow or be based on packet attributes</strong> like length and fragment. It can also be based on the drop rate limit. Although flowspec has been effective in intra-domain environment, it is not so popular in inter-domain environments as it depends on trust and cooperation among competitive networks.</p>
<p>BGP Flowspec is an extension to the BGP protocol which allows rules to be created on the traffic flows and take corresponding actions. This feature of BGP can help mitigate DDoS attacks by specifying appropriate rules. The AS domain borders supporting BGP Flowspec are capable of matching packets in a specific flow based on a variety of parameters such as source IP, destination IP, packet length, protocol used, etc.</p>
<p>The following table shows the available components with an example for FlowSpec:</p>
<img src="https://i.imgur.com/dV76r6i.png" style="width: 800px" />
<p>BGP Flowspec example: The following flow specification rule (specified here in a dictionary format) filters all HTTP/HTTPS traffic from port 80 and 443 to one of the Google servers with IP 172.217.19.195 from subnet 130.89.161.0/24.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> </span><br><span class="line">   <span class="attr">&quot;type 1&quot;</span><span class="punctuation">:</span> <span class="string">&quot;172.217.19.195/32&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;type 2&quot;</span><span class="punctuation">:</span> <span class="string">&quot;130.89.161.0/24&quot;</span> <span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;type 3&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">6</span><span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">   <span class="attr">&quot;type 5&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">80</span><span class="punctuation">,</span> <span class="number">443</span><span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">   <span class="attr">&quot;action&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> </span><br><span class="line">       <span class="attr">&quot;type &quot;</span><span class="punctuation">:</span> <span class="string">&quot;traffic-rate&quot;</span><span class="punctuation">,</span> </span><br><span class="line">       <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span> </span><br><span class="line">      <span class="punctuation">&#125;</span> </span><br></pre></td></tr></table></figure>
<p>A “traffic-rate” action with value 0 discards the traffic. The other possible actions include rate limiting, redirecting or filtering. If no rule is specified, the default action for a rule is to accept the incoming traffic.</p>
<p>In contrast to ACL filters, FlowSpec leverages the BGP control plane making it easier to add rules to all the routers simultaneously. Although FlowSpec is seen to be effective in intra-domain environment, it is not so popular in inter-domain environments as it depends on trust and cooperation among competitive networks. Also, it might not scale for large attacks where the attack traffic originates from multiple sources as it would multiple rules or combining the sources into one prefix.</p>
<h3 id="DDoS-Mitigation-Techniques">DDoS Mitigation Techniques</h3>
<h4 id="BGP-Blackholing">BGP Blackholing</h4>
<p>In this topic, we will talk about a technique called BGP blackholing, that is a countermeasure to mitigate a DDoS attack.</p>
<p>With this mechanism, all the attack traffic to a targeted DDoS destination is dropped to a null location. The premise of this approach is that <u>the traffic is stopped <strong>closer to the source</strong> of the attack and before it reaches the targeted victim.</u>[Quiz] For a high volume attack, it proves to be an effective strategy when compared to other mitigation options.</p>
<p>This technique is implemented either with the help of the upstream provider or with the help of the IXP (if the network is peering at an IXP). With this technique, the victim AS uses BGP to communicate the attacked destination prefix to its upstream AS, which then drops the attack traffic towards this prefix. Then either the provider (or the IXP) will advertise a more specific prefix and modifying the next-hop address that will divert the attack traffic to a null interface. The blackhole messages are tagged with a specific BGP blackhole community attribute, usually publicly available, to differentiate it from the regular routing updates.</p>
<p>Let’s look at the scenario, where blackholing is implemented with the help of an upstream provider.</p>
<p>A network that offers blackholing service is known as a blackholing provider. It is also responsible for providing the blackholing community that should be used. Network or customer providers act as blackholing providers at the network edge. Internet Service Providers (ISPs) or Internet Exchange Points (IXPs) act as blackholing providers at the Internet core.</p>
<p>If the blackholing provider is a peer or an upstream provider, the AS must announce its associated blackhole community along with the blackhole prefix. Let’s consider the below figure. Assume the IP 130.149.1.1 in AS2 is under attack.</p>
<img src="https://i.imgur.com/QB34LWa.png" style="width: 600px" />
<p>To mitigate this attack, AS2 (victim network) announces a blackholing message to AS1, which is the provider network. The message contains the IP 130.149.1.1/32, which is the host IP under attack and the community field set to AS1 : 666, which is the blackholing community of the AS1 provider. Once the provider receives the message, AS1 identifies it as a blackholing message since it contains its blackholing community and sets the next-hop field of the 130.149.1.1 IP to a blackholing IP, thereby effectively dropping all the incoming traffic to host 130.149.1.1. Thus, the victim host stops receiving the attack traffic that was sent to it.</p>
<p>Let’s look at the scenario, where blackholing is implemented with the help of the IXP where the victim network is already a participant.</p>
<p>In a similar manner, at IXPs, if the AS is a member of an IXP infrastructure and it is under attack, it sends the blackholing messages to the IXP route server when a member connects to the route server. The route server then announces the message to all the connected IXP member ASes, which then drops the traffic towards the blackholed prefix. The null interface to which the traffic should be sent is specified by the IXP. The blackholing message sent to the IXP should contain the IXP blackhole community as shown in the following figure.</p>
<img src="https://i.imgur.com/lK9VAxY.png" style="width: 600px" />
<p>Similar to the previous example, consider here an IP 130.149.1.1 in AS2 that is under attack. The victim AS, AS2 connects to the router server of the IXP and sends a BGP blackholing message. The message contains the IP under attack and the community field set to ASIXP : 666, which is the blackholing community of the IXP. The route server identifies it as a blackholing message and sets the next-hop of the 130.149.1.1 IP to a blackholing IP. It propagates this announcement to all its member ASes, which then drops all the traffic to host 130.149.1.1.</p>
<h4 id="BGP-Blackholing-Limitations-and-Problems">BGP Blackholing Limitations and Problems</h4>
<p>One of the major drawbacks of BGP blackholing is that the destination under attack becomes unreachable since all the traffic including the legitimate traffic is dropped.</p>
<p>Consider the DDoS attack scenario in the given figure (a), where there is no mitigation strategy in place. In the control plane, the prefix 100.10.10.0/24 is advertised by AS1. Suppose a web service running on IP 100.10.10.10 comes under attack, which falls under AS1. As shown in the bottom section of figure (a), this results in the unreachability of the service by users from both AS2 and AS3 as the network port in AS1 becomes overloaded.</p>
<img src="https://i.imgur.com/a60NczQ.png" style="width: 600px" />
<p>Now, consider the scenario where AS1 uses BGP blackholing to send an update to the IXP’s route server. The message contains the prefix 100.10.10.10/32 along with the IXP’s blackhole community (IXP_ASN: 666). The route server propagates this update to the other ASes, AS2 and AS3, shown in the top section of figure (b).</p>
<p>Let’s assume the case where AS2 accepts the announcement and that AS3 rejects it. The possible reasons for an AS rejecting the announcement could include voluntarily choosing not to participate in blackholing, rejecting updates that require additional config changes or it could simply be that the AS made a misconfiguration mistake.</p>
<p>Since AS2 accepts the announcement, the next hop IP for AS2 to reach the prefix under attack is changed to the IXP’s blackholing IP and traffic towards IP 100.10.10.10/32 via AS2 is dropped. However, this causes collateral damage since all the traffic including legitimate traffic via AS2 is dropped.</p>
<img src="https://i.imgur.com/FJWw6Tc.png" style="width: 600px" />
<p>Also, since AS3 does not honor the announcement, it allows all the traffic including the legitimate and attacks traffic towards IP 100.10.10.10/32 to flow via AS3.</p>
<p>As a result, and if the majority of the attack traffic is coming through AS3,  then the mitigation is ineffective. The same is true if a large number of peers do not accept the blackholing announcements.</p>
<p>Let’s look at the traffic distribution during an attack at a large IXP, and gather some insights to understand the extent of the collateral damage caused by blackholing.</p>
<img src="https://i.imgur.com/7uhPsod.png" style="width: 600px" />
<p>As can be seen from the above figure, the traffic mostly contains web traffic on ports 80 (HTTP) and 443 (HTTPS). The attack traffic, shown in red, is majorly from the UDP port 11211 and occupies almost 70% of the entire traffic. This suggests an amplification attack. The ideal solution here would be to block the traffic only from the UDP port (11211), while allowing the remaining traffic from other ports to pass through. However, the blackholing service drops all traffic including the ones from other ports, which is still a significant amount.</p>
<h2 id="References">References</h2>
<ul>
<li>ARTEMIS: Neutralizing BGP Hijacking Within a Minute <a target="_blank" rel="noopener" href="https://www.inspire.edu.gr/wp-content/pdfs/artemis_TON2018.pdf">https://www.inspire.edu.gr/wp-content/pdfs/artemis_TON2018.pdf</a></li>
</ul>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>


<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js" integrity="sha384-97gW6UIJxnlKemYavrqDHSX3SiygeOwIZhwyOKRfSaf0JWKRVj9hLASHgFTzT+0O" crossorigin="anonymous"></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">
  
  <div class="divider"></div>
</div>

  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>

      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
