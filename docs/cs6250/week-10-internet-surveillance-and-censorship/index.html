<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.png" />
    

    <title>
        
          Eric&#39;s CS Notes
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- theme css & js -->
    
<link rel="stylesheet" href="/css/book.css">

    
<script src="/js/book.js"></script>


    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.18.2/tocbot.css">
    
    <!-- katex css -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" integrity="sha384-Juol1FqnotbkyZUT5Z7gUPjQ9gzlwCENvUZTpQBAPxtusdwFLRy382PSDx5UUJ4/" crossorigin="anonymous">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('.book-content img')
})
</script>

<meta name="generator" content="Hexo 6.3.0"></head>


<body>

<div class="book-container">
  <div class="book-sidebar">
    <div class="book-brand">
  <a href="/">
    <img src="/favicon.png">
    <span>ERIC&#39;S CS NOTES</span>
  </a>
</div>

    <div class="book-menu">
  <!--
## Introduction to Probability

* [Unit 1: Probability models and axioms](/introduction-to-probability/unit-1/index.html)
* [Unit 2: Conditioning and independence](/introduction-to-probability/unit-2/index.html)
* [Unit 3: Counting](/introduction-to-probability/unit-3/index.html)
* [Unit 4: Discrete random variables](/introduction-to-probability/unit-4/index.html)
* [Unit 5: Continuous random variables](/introduction-to-probability/unit-5/index.html)
* [Unit 6: Further topics on random variables](/introduction-to-probability/unit-6/index.html)
* [Unit 7: Bayesian inference](/introduction-to-probability/unit-7/index.html)
* [Unit 8: Limit theorems and classical statistics](/introduction-to-probability/unit-8/index.html)
* [Unit 9: Bernoulli and Poisson processes](/introduction-to-probability/unit-9/index.html)
* [Unit 10: Markov chains](/introduction-to-probability/unit-10/index.html)
-->
<!--
## Multivariable Calculus

* [Unit 1: Thinking about multivariable functions](/multivariable-calculus/unit-1/index.html)
* [Unit 2: Derivatives of multivariable functions](/multivariable-calculus/unit-2/index.html)

* [Unit 3: Applications of multivariable derivatives](/multivariable-calculus/unit-3/index.html)
* [Unit 4: Integrating multivariable functions](/multivariable-calculus/unit-4/index.html)
* [Unit 5: Green's, Stokes', and the divergence theorems](/multivariable-calculus/unit-5/index.html)
-->
<h2 id="cs6210-advanced-operating-systems"><a class="markdownIt-Anchor" href="#cs6210-advanced-operating-systems"></a> CS6210: Advanced Operating Systems</h2>
<ul>
<li><a href="/cs6210/lesson-02/index.html">Lesson 02: OS Structure</a></li>
<li><a href="/cs6210/lesson-03/index.html">Lesson 3: Virtualization</a></li>
<li><a href="/cs6210/lesson-04-1/index.html">Lesson 4: Parallel Systems - Part 1</a></li>
<li><a href="/cs6210/lesson-04-2/index.html">Lesson 4: Parallel Systems - Part 2</a></li>
<li><a href="/cs6210/lesson-05/index.html">Lesson 5: Distributed Systems</a></li>
</ul>
<!--
* [Lesson 6: Distributed Objects and Middleware](/cs6210/lesson-06/index.html)
* [Lesson 7: Distributed Subsystems](/cs6210/lesson-07/index.html)
* [Lesson 9: Internet Computing](/cs6210/lesson-09/index.html)
* [Lesson 10: RT and Multimedia](/cs6210/lesson-10/index.html)
* [Lesson 8: Failures and Recovery](/cs6210/lesson-08/index.html)
* [Lesson 11: Security](/cs6210/lesson-11/index.html)
-->
<h2 id="cs6250-computer-networks"><a class="markdownIt-Anchor" href="#cs6250-computer-networks"></a> CS6250 Computer Networks</h2>
<ul>
<li><a href="/cs6250/week-1-internet-architecture/index.html">Week 1 - Internet Architecture</a></li>
<li><a href="/cs6250/week-2-transport-and-application-layers/index.html">Week 2 - Transport and Application Layers</a></li>
<li><a href="/cs6250/week-3-intradomain-routing/index.html">Week 3 - Intradomain Routing</a></li>
<li><a href="/cs6250/week-4-as-relationships-and-interdomain-routing/index.html">Week 4 - AS Relationships and Interdomain Routing</a></li>
<li><a href="/cs6250/week-5-router-design-and-algorithems-part-1/index.html">Week 5 - Router Design and Algorithms (Part 1)</a></li>
<li><a href="/cs6250/week-6-router-design-and-algorithems-part-2/index.html">Week 6 - Router Design and Algorithms (Part 2)</a></li>
<li><a href="/cs6250/week-7-software-defined-networking-part-1/index.html">Week 7 - Software Defined Networking (Part 1)</a></li>
<li><a href="/cs6250/week-8-software-defined-networking-part-2/index.html">Week 8 - Software Defined Networking (Part 2)</a></li>
<li><a href="/cs6250/week-9-internet-security/index.html">Week 9 - Internet Security</a></li>
<li><a href="/cs6250/week-10-internet-surveillance-and-censorship/index.html">Week 10 - Internet Surveillance and Censorship</a></li>
<li><a href="/cs6250/week-11-applications-video/index.html">Week 11 - Applications Videos</a></li>
<li><a href="/cs6250/week-12-applications-cdns-and-overlay-networks/index.html">Week 12 - Applications CDNs and Overlay Networks</a></li>
</ul>
<h2 id="cs6200-graduate-introduction-to-operating-systems"><a class="markdownIt-Anchor" href="#cs6200-graduate-introduction-to-operating-systems"></a> CS6200 Graduate Introduction to Operating Systems</h2>
<ul>
<li><a href="/cs6200/p1-preparation/index.html">P0 - Preparation</a></li>
<li><a href="/cs6200/p1l2-introduction/index.html">P1L2 - Introduction</a></li>
<li><a href="/cs6200/p2l1-processes-and-process-management/index.html">P2L1 - Processes and Process Management</a></li>
<li><a href="/cs6200/p2l2-threads-and-concurrency/index.html">P2L2 - Threads and Concurrency</a></li>
<li><a href="/cs6200/p2l3-pthread/index.html">P2L3 - PThread</a></li>
<li><a href="/cs6200/p2l4-thread-design-consideration/index.html">P2L4 - Thread Design Considerations</a></li>
<li><a href="/cs6200/p2l5-thread-performance-consideration/index.html">P2L5 - Thread Performance Considerations</a></li>
<li><a href="/cs6200/p3l1-scheduling/index.html">P3L1 - Scheduling</a></li>
<li><a href="/cs6200/p3l2-memory-management/index.html">P3L2 - Memory Management</a></li>
<li><a href="/cs6200/p3l3-inter-process-communication/index.html">P3L3 - Inter-Process Communication</a></li>
<li><a href="/cs6200/p3l4-synchronization-constructs/index.html">P3L4 - Synchronization Constructs</a></li>
<li><a href="/cs6200/p3l5-io-management/index.html">P3L5 - I/O Management</a></li>
<li><a href="/cs6200/p3l6-virtualization/index.html">P3L6 - Virtualization</a></li>
</ul>
<!--
* [P4L1 - Remote Procedure Calls](/cs6200/p4l1-remote-procedure-calls/index.html) 
* [P4L2 - Distributed File Systems](/cs6200/p4l2-distributed-file-systems/index.html) 
* [P4L3 - Distributed Shared Memory](/cs6200/p4l3-distributed-shared-memory/index.html) 
* [P4L4 - Datacenter Technologies](/cs6200/p4l4-datacenter-technologies/index.html) 
-->
<h2 id="algorithms-part-ii"><a class="markdownIt-Anchor" href="#algorithms-part-ii"></a> Algorithms: Part II</h2>
<ul>
<li><a href="/algorithms-2/week-1/index.html">Week 1 - Undirected Graph &amp; Directed Graph</a></li>
<li><a href="/algorithms-2/week-2/index.html">Week 2 - Minimum Spanning Trees &amp; Shortest Path</a></li>
<li><a href="/algorithms-2/week-3/index.html">Week 3 - Maximum Flow and Minimum Cut &amp; String Sort</a></li>
<li><a href="/algorithms-2/week-4/index.html">Week 4 - Tries &amp; Substring Search</a></li>
<li><a href="/algorithms-2/week-5/index.html">Week 5 - Regular Expressions</a></li>
<li><a href="/algorithms-2/week-6/index.html">Week 6 - Reductions</a></li>
</ul>
<h2 id="algorithms-part-i"><a class="markdownIt-Anchor" href="#algorithms-part-i"></a> Algorithms: Part I</h2>
<ul>
<li><a href="/algorithms-1/week-1/index.html">Week 1 - Union-Find &amp; Analysis of Algorithms</a></li>
<li><a href="/algorithms-1/week-2/index.html">Week 2 - Stacks and Queues &amp; Elementary Sorts</a></li>
<li><a href="/algorithms-1/week-3/index.html">Week 3 - Mergesort &amp; Quicksort</a></li>
<li><a href="/algorithms-1/week-4/index.html">Week 4 - Priority Queues &amp; Elementary Symbols</a></li>
<li><a href="/algorithms-1/week-5/index.html">Week 5 - Balanced Search Trees</a></li>
<li><a href="/algorithms-1/week-6/index.html">Week 6 - Hash Tables</a></li>
</ul>
<h2 id="introduction-to-software-design-and-architecture"><a class="markdownIt-Anchor" href="#introduction-to-software-design-and-architecture"></a> Introduction to Software Design and Architecture</h2>
<ul>
<li><a href="/introduction-to-software-design-and-architecture/design-pattern/index.html">Design Pattern</a></li>
</ul>
<h2 id="calculus-two-sequences-and-series"><a class="markdownIt-Anchor" href="#calculus-two-sequences-and-series"></a> Calculus Two: Sequences and Series</h2>
<ul>
<li><a href="/calculus-two/week-1/index.html">Week 1 - Sequences</a></li>
<li><a href="/calculus-two/week-2/index.html">Week 2 - Series</a></li>
<li><a href="/calculus-two/week-3/index.html">Week 3 - Convergence Tests</a></li>
<li><a href="/calculus-two/week-4/index.html">Week 4 - Alternating Series</a></li>
<li><a href="/calculus-two/week-5/index.html">Week 5 - Power Series</a></li>
<li><a href="/calculus-two/week-6/index.html">Week 6 - Taylor Series</a></li>
</ul>
<h2 id="laff-linear-algebra"><a class="markdownIt-Anchor" href="#laff-linear-algebra"></a> LAFF Linear Algebra</h2>
<ul>
<li><a href="/laff-linear-algebra/week-1/index.html">Week 1 - Vectors in Linear Algebra</a></li>
<li><a href="/laff-linear-algebra/week-2/index.html">Week 2 - Linear Transformations and Matrices</a></li>
<li><a href="/laff-linear-algebra/week-3/index.html">Week 3 - Matrix-Vector Operations</a></li>
<li><a href="/laff-linear-algebra/week-4/index.html">Week 4 - Matrix-Vector to Matrix-Matrix Multiplication</a></li>
<li><a href="/laff-linear-algebra/week-5/index.html">Week 5 - Matrix- Matrix Multiplication</a></li>
<li><a href="/laff-linear-algebra/week-6/index.html">Week 6 - Gaussian Elimination</a></li>
<li><a href="/laff-linear-algebra/week-7/index.html">Week 7 - More Gaussian Elimination and Matrix Inversion</a></li>
<li><a href="/laff-linear-algebra/week-8/index.html">Week 8 - More on Matrix Inversion</a></li>
<li><a href="/laff-linear-algebra/week-9/index.html">Week 9 - Vector Spaces</a></li>
<li><a href="/laff-linear-algebra/week-10/index.html">Week 10 - Vector Spaces, Orthogonality, and Linear Least-Squares</a></li>
<li><a href="/laff-linear-algebra/week-11/index.html">Week 11 - Orthogonal Projection, Low Rank Approximation, and Orthogonal Bases</a></li>
<li><a href="/laff-linear-algebra/week-12/index.html">Week 12 - Eigenvalues and Eigenvectors</a></li>
</ul>
<h2 id="stanford-machine-learning"><a class="markdownIt-Anchor" href="#stanford-machine-learning"></a> Stanford Machine Learning</h2>
<ul>
<li><a href="/stanford-machine-learning/week-1/index.html">Week 1 - Introduction</a></li>
<li><a href="/stanford-machine-learning/week-2/index.html">Week 2 - Linear Regression with Multiple Variables</a></li>
<li><a href="/stanford-machine-learning/week-3/index.html">Week 3 - Logistic Regression &amp; Regularization</a></li>
<li><a href="/stanford-machine-learning/week-4/index.html">Week 4 - Neural Networks: Representation</a></li>
<li><a href="/stanford-machine-learning/week-5/index.html">Week 5 - Neural Networks: Learning</a></li>
<li><a href="/stanford-machine-learning/week-6a/index.html">Week 6a - Advice for Applying Machine Learning</a></li>
<li><a href="/stanford-machine-learning/week-6b/index.html">Week 6b - Machine Learning System Design</a></li>
<li><a href="/stanford-machine-learning/week-7/index.html">Week 7 - Support Vector Machines</a></li>
<li><a href="/stanford-machine-learning/week-8/index.html">Week 8 - Unsupervised Learning &amp; Dimensionality Reduction</a></li>
<li><a href="/stanford-machine-learning/week-9a/index.html">Week 9a - Anomaly Detection</a></li>
<li><a href="/stanford-machine-learning/week-9b/index.html">Week 9b - Recommender Systems</a></li>
<li><a href="/stanford-machine-learning/week-10/index.html">Week 10 - Large Scale Machine Learning</a></li>
<li><a href="/stanford-machine-learning/week-11/index.html">Week 11 - Application Example: Photo OCR</a></li>
</ul>
<h2 id="calculus-one"><a class="markdownIt-Anchor" href="#calculus-one"></a> Calculus One</h2>
<ul>
<li><a href="/calculus-one/week-2-3/index.html">Week 2-3 - Functions &amp; Limits</a></li>
<li><a href="/calculus-one/week-4/index.html">Week 4 - The Beginning of Derivatives</a></li>
<li><a href="/calculus-one/week-5/index.html">Week 5 - Techniques of Differentiation</a></li>
<li><a href="/calculus-one/week-6/index.html">Week 6 - Chain Rule</a></li>
<li><a href="/calculus-one/week-7/index.html">Week 7 - Derivatives of Trigonometric Functions</a></li>
<li><a href="/calculus-one/week-8/index.html">Week 8 - Derivatives in the Real World</a></li>
<li><a href="/calculus-one/week-9/index.html">Week 9 - Optimization</a></li>
<li><a href="/calculus-one/week-10/index.html">Week 10 - Linear Approximation</a></li>
<li><a href="/calculus-one/week-11-12/index.html">Week 11-12 - Antidifferentiation &amp; Integration</a></li>
<li><a href="/calculus-one/week-13/index.html">Week 13 - Fundamental Theorem of Calculus</a></li>
<li><a href="/calculus-one/week-14/index.html">Week 14 - Substitution Rule</a></li>
<li><a href="/calculus-one/week-15/index.html">Week 15 - Techniques of Integration</a></li>
<li><a href="/calculus-one/week-16/index.html">Week 16 - Applications of Integration</a></li>
</ul>
<h2 id="computational-thinking"><a class="markdownIt-Anchor" href="#computational-thinking"></a> Computational Thinking</h2>
<ul>
<li><a href="/computational-thinking/lecture-1/index.html">Lecture 1 - Optimization and Knapsack Problem</a></li>
<li><a href="/computational-thinking/lecture-2/index.html">Lecture 2 - Decision Trees and Dynamic Programming</a>
<ul>
<li><a href="/computational-thinking/lecture-2-powerset/index.html">Exercise: Power Set Function</a></li>
</ul>
</li>
<li><a href="/computational-thinking/lecture-3/index.html">Lecture 3 - Graphs</a></li>
<li><a href="/computational-thinking/lecture-4-5/index.html">Lecture 4-5 - Plotting</a></li>
<li><a href="/computational-thinking/lecture-6-7/index.html">Lecture 6-7 - Stochastic Programs &amp; Inferential Statistics</a></li>
<li><a href="/computational-thinking/lecture-8/index.html">Lecture 8 - Monte Carlo Simulation</a></li>
<li><a href="/computational-thinking/lecture-9/index.html">Lecture 9 - Sampling and Standard Error</a></li>
<li><a href="/computational-thinking/lecture-10-11/index.html">Lecture 10-11 - Experimental Data</a></li>
<li><a href="/computational-thinking/lecture-12/index.html">Lecture 12 - Machine Learning</a></li>
<li><a href="/computational-thinking/lecture-13/index.html">Lecture 13 - Statistical Abuses</a></li>
</ul>
<h2 id="effective-thinking-through-mathematics"><a class="markdownIt-Anchor" href="#effective-thinking-through-mathematics"></a> Effective Thinking Through Mathematics</h2>
<ul>
<li><a href="/effective-thinking-through-mathematics/note/index.html">Note</a></li>
<li><a href="/effective-thinking-through-mathematics/week-4-telling-the-story-of-infinity/index.html">Week 4 (/Telling the Story of Infinity)</a></li>
<li><a href="/effective-thinking-through-mathematics/week-5-telling-the-story-of-the-euler-circuit-theorem/index.html">Week 5 (/Telling the Story of Euler Circuit Theorem)</a></li>
</ul>
<h2 id="cs50-introduction-to-computer-science"><a class="markdownIt-Anchor" href="#cs50-introduction-to-computer-science"></a> CS50 Introduction to Computer Science</h2>
<ul>
<li><a href="/cs50/week-1/index.html">Week 1 - C</a></li>
<li><a href="/cs50/week-2/index.html">Week 2 - Arrays</a></li>
<li><a href="/cs50/week-3/index.html">Week 3 - Algorithms</a></li>
<li><a href="/cs50/week-4/index.html">Week 4 - Memory</a></li>
<li><a href="/cs50/week-5/index.html">Week 5 - Data Structures</a></li>
<li><a href="/cs50/week-6/index.html">Week 6 - HTTP</a></li>
<li><a href="/cs50/week-7-10/index.html">Week 7-10 - Machine Learning/Python/SQL/Javascript</a></li>
</ul>
<h2 id="others"><a class="markdownIt-Anchor" href="#others"></a> Others</h2>
<ul>
<li><a href="/symbols/index.html">Symbols of Mathematics</a></li>
<li><a href="/glossary/index.html">Glossary</a></li>
</ul>
<h2 id="about-me"><a class="markdownIt-Anchor" href="#about-me"></a> <a target="_blank" rel="noopener" href="https://ericyy.me/about/">About Me</a></h2>

</div>


<script src="/js/book-menu.js"></script>

  </div>

  <div class="sidebar-toggle" onclick="sidebar_toggle()" onmouseover="add_inner()" onmouseleave="remove_inner()">
  <div class="sidebar-toggle-inner"></div>
</div>

<script>
function add_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.add('show')  
}

function remove_inner() {
  let inner = document.querySelector('.sidebar-toggle-inner')
  inner.classList.remove('show')
}

function sidebar_toggle() {
    let sidebar_toggle = document.querySelector('.sidebar-toggle')
    let sidebar = document.querySelector('.book-sidebar')
    let content = document.querySelector('.off-canvas-content')
    if (sidebar_toggle.classList.contains('extend')) { // show
        sidebar_toggle.classList.remove('extend')
        sidebar.classList.remove('hide')
        content.classList.remove('extend')
    }
    else { // hide
        sidebar_toggle.classList.add('extend')
        sidebar.classList.add('hide')
        content.classList.add('extend')
    }
}
</script>

  <div class="off-canvas-content">
    <div class="columns">
      <div class="column col-10 col-lg-12">
        <div class="book-navbar">
          <!-- For Responsive Layout -->

<header class="navbar">
  <section class="navbar-section">
    <a onclick="open_sidebar()">
      <i class="icon icon-menu"></i>
    </a>
  </section>
</header>

        </div>
        <div class="book-content">
          <div class="book-post">
  <h1 id="week-10-internet-surveillance-and-censorship"><a class="markdownIt-Anchor" href="#week-10-internet-surveillance-and-censorship"></a> Week 10 - Internet Surveillance and Censorship</h1>
<!-- toc -->
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#dns-censorship">DNS Censorship</a>
<ul>
<li><a href="#what-is-dns-censorship">What is DNS censorship?</a></li>
<li><a href="#example-dns-censorship-techniques">Example DNS Censorship Techniques</a>
<ul>
<li><a href="#what-are-the-different-dns-censorship-techniques">What are the different DNS censorship techniques?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#why-is-dns-manipulation-difficult-to-measure">Why is DNS Manipulation Difficult to Measure?</a>
<ul>
<li><a href="#example-censorship-detection-systems-and-their-limitations">Example Censorship Detection Systems and Their Limitations</a></li>
<li><a href="#dns-censorship-a-global-measurement-methodology">DNS Censorship: A Global Measurement Methodology</a></li>
</ul>
</li>
<li><a href="#censorship-through-connectivity-disruptions">Censorship Through Connectivity Disruptions</a>
<ul>
<li><a href="#optional-reading-connectivity-disruptions-a-case-study">Optional Reading: Connectivity Disruptions: A Case Study</a></li>
<li><a href="#connectivity-disruptions-detection">Connectivity Disruptions: Detection</a></li>
<li><a href="#optional-censorship-over-social-media">Optional: Censorship Over Social Media</a></li>
</ul>
</li>
<li><a href="#references">References:</a></li>
</ul>
<!-- tocstop -->
<hr />
<h2 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h2>
<p>In this lecture, we learn about techniques that attackers have developed to abuse popular protocols that we have learned about in earlier lectures (such as DNS and BGP) with the goal to control access to information.</p>
<p>We will focus on three types of censorship:</p>
<p>Internet connectivity, DNS censorship, and social media-based censorship.</p>
<h2 id="dns-censorship"><a class="markdownIt-Anchor" href="#dns-censorship"></a> DNS Censorship</h2>
<h3 id="what-is-dns-censorship"><a class="markdownIt-Anchor" href="#what-is-dns-censorship"></a> What is DNS censorship?</h3>
<p>DNS censorship is a large scale network traffic filtering strategy opted by a network to enforce control and censorship over Internet infrastructure to suppress material which they deem as objectionable. An example of large scale DNS censorship that is implemented by networks located in China use a firewall, and it is popularly known as the Great Firewall of China (GFW). This firewall looks like an opaque system that uses various techniques to censor China’s Internet traffic and block access to various foreign websites.</p>
 <img src="https://i.imgur.com/SWqoqD0.png" style="width: 800px" />
<p>The GFW (shown in the figure above) works by <strong>injecting fake DNS record responses so that access to a domain name is blocked.</strong> Since the GFW is an opaque system, several different studies have been performed to deduce the actual nature of the system and its functionality.</p>
<p>Researchers have tried to reverse engineer the GFW and to understand how it works. Researchers have started to identify some of the properties:</p>
<ol>
<li><em>Locality of GFW nodes</em>: There are two differing notions on whether the GFW nodes are present only at the edge ISPs or whether they are also present in non-bordering Chinese ASes. The majority view is that censorship nodes are present at the edge.</li>
<li><em>Centralized management</em>: Since the blocklists obtained from two distinct GFW locations are the same, there is a high possibility of a <strong>central management (GFW Manager) entity</strong> that orchestrates blocklists.</li>
<li><em>Load balancing</em>: GFW load balances between processes based on <u>source and destination IP address.</u> The processes are clustered together to collectively send injected DNS responses.</li>
</ol>
<p><strong>Organizations that track the GFW</strong></p>
<p>There are multiple organizations that monitor Chinese censorship for censored domains on a continuous basis, some of which are listed below:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://geatfire.org">geatfire.org</a> (since 2011)</li>
<li><a target="_blank" rel="noopener" href="http://hikinggfw.org">hikinggfw.org</a> (since 2012)</li>
</ul>
<h3 id="example-dns-censorship-techniques"><a class="markdownIt-Anchor" href="#example-dns-censorship-techniques"></a> Example DNS Censorship Techniques</h3>
<p><strong>DNS injection</strong> is one of the most common censorship technique employed by the GFW. The GFW <strong>uses a ruleset(not src/dest IPs) to determine when to inject DNS replies to censor network traffic</strong>[Quiz]. To start with, it is important to identify and isolate the networks that use DNS injection for censorship. The authors of the paper titled “Towards a Comprehensive Picture of the Great Firewall’s DNS Censorship” use probing techniques and vantage points to search for injected paths and then evaluate the injection.</p>
<p>When tested against probes for restricted and benign domains, the accuracy of DNS open resolvers to accurately pollute the response is recorded over 99.9%. The steps involved in DNS injection are:</p>
<ol>
<li>DNS probe is sent to the open DNS resolvers</li>
<li>The probe is checked against the blocklist of domains and keywords</li>
<li>For <strong>domain level blocking</strong>, a fake DNS A record response is sent back. There are two levels of blocking domains: the first one is by directly <strong>blocking the domain,</strong> and the second one is by <strong>blocking it based on keywords present in the domain</strong>.</li>
</ol>
<h4 id="what-are-the-different-dns-censorship-techniques"><a class="markdownIt-Anchor" href="#what-are-the-different-dns-censorship-techniques"></a> What are the different DNS censorship techniques?</h4>
<p>Some of the DNS censorship techniques are more elementary, and some are more elaborate in functioning and implementation. Usually, a censorship system implements these techniques in combination to effect censorship on a network.</p>
<p><strong>Technique 1: Packet Dropping</strong></p>
<p>As the name suggests, in packet dropping, all network <strong>traffic going to a set of specific IP addresses is discarded</strong>[Quiz]. The censor identifies undesirable traffic and chooses to not properly forward any packets it sees associated with the traversing undesirable traffic instead of following a normal routing protocol.</p>
<p><strong>Strengths</strong></p>
<ol>
<li>Easy to implement</li>
<li>Low cost</li>
</ol>
<p><strong>Weaknesses</strong></p>
<ol>
<li>Maintenance of blocklist - It is challenging to stay up to date with the list of IP addresses to block</li>
<li>Overblocking - If two websites share the same IP address and the intention is to only block one of them, there’s a risk of blocking both</li>
</ol>
<p><strong>Technique 2: DNS Poisoning</strong></p>
<p>When a DNS receives a query for resolving hostname to IP address - if there is no answer returned or an incorrect answer is sent to redirect or mislead the user request, this scenario is called DNS Poisoning.</p>
<p><strong>Strength</strong></p>
<p>No overblocking: Since there is an extra layer of hostname translation, <strong>access to specific hostnames can be blocked versus blanket IP address blocking</strong>.</p>
<p><strong>Weakness</strong></p>
<p>Blocks the entire domain. It is not possible to allow email contact while blocking the website.</p>
<p><strong>Technique 3: Content Inspection</strong></p>
<p>3A. <em>Proxy-based content inspection</em>: This censorship technique is more sophisticated, in that it allows for all network traffic to pass through a proxy where the traffic is examined for content, and <strong>the proxy rejects requests that serve objectionable content</strong>[Quiz].</p>
<p><strong>Strengths</strong></p>
<ol>
<li>Precise censorship: A very <strong>precise level of censorship</strong> can be achieved, <u>down to the level of single web pages or even objects </u>within the web page.</li>
<li>Flexible: Works well with hybrid security systems. E.g., with a combination of other censorship techniques like packet dropping and DNS poisoning.</li>
</ol>
<p><strong>Weakness</strong></p>
<p>Not scalable: They are expensive to implement on a large scale network as the processing overhead is large (through a proxy)</p>
<p>3B. <em>Intrusion detection system (IDS)</em> based <strong>content inspection</strong>: An alternative approach is to use parts of an IDS to inspect network traffic. An IDS is easier and more cost effective to implement than a proxy based system as it is more responsive than reactive in nature, in that it informs the firewall rules for future censorship.</p>
<p><strong>Technique 4: Blocking with Resets</strong></p>
<p>The GFW employs this technique where it sends a TCP reset (RST) to <u>block individual connections that contain requests with objectionable content.</u>[Quiz] We can see this by packet capturing of requests that are normal and requests that contain <strong>potentially flaggable keywords</strong>[Quiz]. Let’s look at one such example of packet capture.</p>
<p><strong>Request 1: Requesting a benign web page</strong></p>
<p>Here, we see a packet trace from a client in Cambridge (cam 53382) to a website based in China (china(http)) for a web page which is benign:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cam(53382)  → china(http) [SYN] </span><br><span class="line">china(http) → cam(53382) [SYN, ACK] </span><br><span class="line">cam(53382)  → china(http) [ACK] </span><br><span class="line">cam(53382)  → china(http) GET / HTTP/1.0 </span><br><span class="line">china(http) → cam(53382) HTTP/1.1 200 OK (text/html) etc...</span><br><span class="line">china(http) → cam(53382) ...more of the web page </span><br><span class="line">cam(53382)  → china(http) [ACK]</span><br><span class="line">            ...and so on until the page was complete</span><br></pre></td></tr></table></figure>
<p>Ultimately, the website was served successfully.</p>
<p><strong>Request 2: Requesting with a potentially flaggable text within the HTTP GET request</strong></p>
<p>Here, we have a packet trace which contains flagged text:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cam(54190)  → china(http) [SYN] </span><br><span class="line">china(http) → cam(54190) [SYN, ACK] TTL=39 </span><br><span class="line">cam(54190)  → china(http) [ACK]</span><br><span class="line">cam(54190)  → china(http) GET /?falun HTTP/1.0 </span><br><span class="line">china(http) → cam(54190) [RST] TTL=47, seq=1, ack=1 &lt;--</span><br><span class="line">china(http) → cam(54190) [RST] TTL=47, seq=1461, ack=1  &lt;--</span><br><span class="line">china(http) → cam(54190) [RST] TTL=47, seq=4381, ack=1 &lt;--</span><br><span class="line">china(http) → cam(54190) HTTP/1.1 200 OK (text/html) etc...</span><br><span class="line">cam(54190)  → china(http) [RST] TTL=64, seq=25, ack zeroed </span><br><span class="line">china(http) → cam(54190) ...more of the web page</span><br><span class="line">cam(54190)  → china(http) [RST] TTL=64, seq=25, ack zeroed </span><br><span class="line">china(http) → cam(54190) [RST] TTL=47, seq=2921, ack=25</span><br></pre></td></tr></table></figure>
<p>After the client (cam54190) sends the request containing flaggable keywords, it receives 3 TCP RSTs corresponding to one request, possibly to ensure that the sender receives a reset. The RST packets received correspond to the sequence number of 1460 sent in the GET request.</p>
<ul>
<li>Note that the GFW reset the connection after the ACK sent by the client in Cambridge.[Quiz]</li>
</ul>
<p><strong>Technique 5: Immediate Reset of Connections</strong></p>
<p>Censorship systems like GFW have blocking rules in addition to inspecting content, <u>to suspend traffic coming from a source immediately, <strong>for a  short period of time</strong></u>[Quiz].</p>
<p>After sending a request with flaggable keywords (above), we see a series of packet trace, like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cam(54191)  → china(http) [SYN]</span><br><span class="line">china(http) → cam(54191) [SYN, ACK] TTL=41</span><br><span class="line">cam(54191)  → china(http) [ACK]</span><br><span class="line">china(http) → cam(54191) [RST] TTL=49, seq=1</span><br></pre></td></tr></table></figure>
<p>The reset packet received by the client is from the firewall. It does not matter that the client sends out legitimate GET requests following one “questionable” request. It will continue to receive resets from the firewall for a particular duration. Running different experiments suggests that this blocking period is variable for “questionable” requests.</p>
<p>The GFW operates in an on-path fashion, passively examining passing traffic. It may use any combinations of characteristics for filtering.</p>
<h2 id="why-is-dns-manipulation-difficult-to-measure"><a class="markdownIt-Anchor" href="#why-is-dns-manipulation-difficult-to-measure"></a> Why is DNS Manipulation Difficult to Measure?</h2>
<p>Anecdotal evidence suggests that more than 60 countries are currently impacted by control of access to information through the Internet’s Domain Name System (DNS) manipulation. However, our understanding of censorship around the world is relatively limited.</p>
<p>What are the challenges?</p>
<ol>
<li><strong>Diverse Measurements</strong>: Such understanding would need a diverse set of measurements spanning different geographic regions, ISPs, countries, and regions within a single country. Since <u>political dynamics can vary so different ISPs can use various filtering techniques and different organizations may implement censorship at multiple layers of the Internet protocol stack and using different techniques.</u>[Quiz] For example, an ISP may be blocking traffic based on IP address, but another ISP may be blocking individual web requests based on keywords.
<ul>
<li>Therefore, we need widespread longitudinal measurements to understand global Internet manipulation and the heterogeneity of DNS manipulation, across countries, resolvers, and domains.</li>
</ul>
</li>
<li><strong>Need for Scale</strong>: At first, the methods to measure Internet censorship were relying on volunteers who were running measurement software on their own devices. Since this requires them to actually install software and do measurements, we can see that this method is <u>unlikely to reach the scale required.</u>[Quiz] There is a need for methods and tools that are independent of human intervention and participation.</li>
<li><strong>Identifying the intent to restrict content access</strong>: While identifying inconsistent or anomalous DNS responses can help to detect a variety of underlying causes such as misconfigurations, identifying DNS manipulation is different and it requires that we detect the intent to block access to content. It poses its own challenges.
<ul>
<li>So we need to rely on identifying multiple indications to infer DNS manipulation.</li>
</ul>
</li>
<li><strong>Ethics and Minimizing Risks</strong>: Obviously, there are risks associated with involving citizens in censorship measurement studies, based on how <strong>different countries maybe penalizing access to censored material</strong>. <u>Therefore, it is safer to stay away from using DNS resolvers or DNS forwarders in the home networks of individual users</u>. Instead, <u>it is safer to rely on open DNS resolvers</u>[Quiz] that are hosted in Internet infrastructure, for example, within Internet service providers or cloud hosting providers.</li>
</ol>
<h3 id="example-censorship-detection-systems-and-their-limitations"><a class="markdownIt-Anchor" href="#example-censorship-detection-systems-and-their-limitations"></a> Example Censorship Detection Systems and Their Limitations</h3>
<p>However, many such methods are no longer in use. One the most common systems/approaches is the OpenNet Initiative where volunteers perform measurements on their home networks at different times since the past decade. Relying on volunteer efforts make continuous and diverse measurements very difficult.</p>
<p>In addition, Augur is a new system created to perform longitudinal global measurements using TCP/IP side channels (more on Augur soon). However, this system focuses on identifying IP-based disruptions as opposed to DNS-based manipulations.</p>
<h3 id="dns-censorship-a-global-measurement-methodology"><a class="markdownIt-Anchor" href="#dns-censorship-a-global-measurement-methodology"></a> DNS Censorship: A Global Measurement Methodology</h3>
<p>In this section, we explore <u>a method to identify DNS manipulation via machine learning with a system called <strong>Iris</strong></u>. The figure below shows an overview of the identification process.</p>
<img src="https://i.imgur.com/aJ8flZd.png" style="width: 800px" />
<p>In previous sections, we discussed how the lack of diversity is an issue while studying DNS manipulation. In order to counter that, <u>Iris uses open DNS resolvers located all over the globe</u>[Quiz]. In order to <strong>avoid using home routers</strong> (which are usually open due to configuration issues), <u>this dataset is then restricted to a few thousand that are part of the Internet infrastructure</u>(in-house data, no external)[Quiz]. There are two main steps associated with this process:</p>
<ol>
<li>Scanning the Internet’s IPv4 space for open DNS resolvers</li>
<li>Identifying Infrastructure DNS Resolvers</li>
</ol>
<p>Now that we’ve obtained a global set of open DNS resolvers, we need to perform the measurements. The figure above shows the overall measurement process. The steps involved in this measurement process are:</p>
<ol>
<li><strong>Performing global DNS queries</strong> – Iris queries thousands of domains across thousands of open DNS resolvers. To establish a baseline for comparison, the creators included 3 DNS domains that were under their control to help calculate metrics used for evaluation DNS manipulation.</li>
<li><strong>Annotating DNS responses with auxiliary information</strong> – To enable the classification, Iris annotates the IP addresses with additional information such as their geo-location, AS, port 80 HTTP responses, etc. This information is available from the Censys dataset.</li>
<li><strong>Additional PTR and TLS scanning</strong> –<u> One IP address could host several websites via virtual hosting</u>. So, when Censys retrieves certificates from port 443, it could differ from one retrieved via TLS’s Server Name Indication (SNI) extension. This results in discrepancies that could cause Iris to label virtual hosting as DNS inconsistencies. To avoid this, Iris adds PTR and SNI certificates.</li>
</ol>
<p>After annotating the dataset, techniques are performed to clean the dataset and identify whether DNS manipulation is taking place or not. Iris uses two types of metrics to identify this manipulation:</p>
<p><strong>1. Consistency Metrics</strong></p>
<p>Domain access should have some consistency, in terms of network properties, infrastructure, or content, even when accessed from different global vantage points. Using one of the domains Iris controls gives a set of high-confidence consistency baselines. Some consistency metrics used are IP address, Autonomous System, HTTP Content, HTTPS Certificate, PTRs for CDN.</p>
<p><strong>2. Independent Verifiability Metrics</strong></p>
<p>In addition to the consistency metrics, they also use metrics that could be externally verified using external data sources. Some of the independent verifiability metrics used are HTTPS certificate (whether the IP address presents a valid, browser-trusted certificate for the correct domain name when queried without SNI) and HTTPS Certificate with SNI.</p>
<p>If any consistency metric or independent verifiability metric is satisfied, the response is correct. Otherwise, the response is classified as manipulated.</p>
<ul>
<li>The response is inconsistent, but will be classified as correct if the IP address still satisfies an independent verifiability metric (e.g., IP address presents a valid, browser-trusted certificate for the correct domain name).[Quiz]</li>
</ul>
<h2 id="censorship-through-connectivity-disruptions"><a class="markdownIt-Anchor" href="#censorship-through-connectivity-disruptions"></a> Censorship Through Connectivity Disruptions</h2>
<p>In this topic we are talking about a different class of approach to censorship that is based on <strong>connectivity disruptions</strong>.</p>
<p>The highest level of Internet censorship is to completely block access to the Internet. Intuitively, this can be done by manually disconnecting the hardware that are critical to connect to the Internet. Although this seems simple, it may not be feasible as the infrastructure could be distributed over a wide area.</p>
<p>A more subtle approach is to use software to interrupt the routing or packet forwarding mechanisms. Let’s look at how these mechanisms would work:</p>
<ol>
<li>
<p><strong>Routing disruption</strong>:  A routing mechanism decides which part of the network can be reachable. Routers use BGP to communicate updates to other routers in the network. The routers share which destinations it can reach and continuously update its forwarding tables to select the best path for an incoming packet. If this communication is disrupted or disabled on critical routers, it could result in unreachability of the large parts of a network. Using this approach can be easily detectable, as it involves withdrawing previously advertised prefixes or re-advertising them with different properties and therefore modifying the global routing state of the network, which is the control plane.</p>
</li>
<li>
<p><strong>Packet filtering</strong>: Typically, packet filtering is used as a security mechanism in firewalls and switches. But <strong>to disrupt a network’s connectivity, packet filtering can be used to block packets matching a certain criteria disrupting the normal forwarding action</strong>. This approach can be <strong>harder to detect</strong> and might require active probing of the forwarding path or monitoring traffic of the impacted network.</p>
</li>
</ol>
<p>Connectivity disruption can include multiple layers apart from the two methods described above. It can include DNS-based blocking, deep packet inspection by an ISP or the client software blocking the traffic, to list a few.</p>
<h3 id="optional-reading-connectivity-disruptions-a-case-study"><a class="markdownIt-Anchor" href="#optional-reading-connectivity-disruptions-a-case-study"></a> Optional Reading: Connectivity Disruptions: A Case Study</h3>
<p>In early 2011, Internet connectivity was disabled in many North African countries as a response to political developments. Let’s look at the analysis of these disruptions in two countries, Egypt and Libya.</p>
<p>The following figure shows the timeline of the events in the two countries.</p>
<img src="https://i.imgur.com/lQ3trAj.png" style="width: 800px" />
<p>In Egypt, there was a series of political developments.  On 25th January, access to Twitter was blocked and as the political developments intensified, there was a complete shutdown of the Internet on 27th January.</p>
<p>In Libya, similar political developments unfolded about four days after the above incident. On February 17, Youtube was blocked to the users followed by an Internet curfew on February 18, blocking Internet connectivity till 8am in the morning. Later on March 3rd, Internet access was disabled completely for around 4 days.</p>
<p>To analyze these two events, the researchers gathered the following data from various sources:</p>
<ol>
<li>
<p>The Internet numbering resources in or related to the countries were identified using the geolocation data:</p>
<ul>
<li><strong>IP Addresses</strong> - The list of IP addresses geolocated to Egypt and Libya were determined from two sources - the Regional Internet Registries (RIRs) published list and the MaxMind GeoLite Country IP geolocation database.</li>
<li><strong>AS Numbers and BGP-announced prefixes</strong> - The above IP addresses were mapped to BGP-announced prefixes and origin ASes, using publicly available BGP data during the disruption period.</li>
</ul>
</li>
<li>
<p><strong>BGP Control Plane Data</strong>: The BGP updates were obtained from two major sources - Route Views Project [59] and RIPE NCC’s Routing Information Service (RIS). Along with BGP updates, a periodic dump of snapshot of the control plane table was also used to track the reachability of a prefix during the period of disruption. The start and end time of the outage was also determined by <u>observing BGP updates for the withdrawal of prefixes and when it became available again</u>.</p>
</li>
<li>
<p><strong>Darknet Traffic</strong>: Internet background radiation (IBR) refers to unsolicited one-way traffic to unused IP addresses in the Internet. These usually indicate malicious activity on the Internet, including worms, Denial of Service attacks, etc. IBR traffic is observed using network telescopes, called darknets. The three main causes of IBR traffic are due to DoS attacks, scans and bugs and misconfiguration.</p>
</li>
<li>
<p><strong>Active forward path probing</strong>: The active macroscopic traceroute measurements and structured global IPv4 address probing during the outage were also considered in the two countries.</p>
</li>
</ol>
<p><strong>Analysis - Egypt</strong>:</p>
<p>During the outage in Egypt, it was observed that all the routes to Egyptian networks were <strong>withdrawn from the Internet’s global routing table</strong>. The primarily state-owned Internet infrastructure of Egypt, with a small number of parties providing international connectivity and a state telecommunications provider controlling the physical connectivity, enables such manipulation of the system.</p>
<p>The chronological sequence of the outage determined using BGP was found to be synchronized with the reported events. A number of withdrawal routing events were observed between  27th January 22:12:00 GMT and 22:34:00 GMT, signaling the start of the outage. As shown in the graph, the number of visible IP addresses dropped down from 2500 to less than 500.</p>
<img src="https://i.imgur.com/fNLJkNA.png" style="width: 800px" />
<p>As expected, the restoration of Internet connectivity increased the number of re-announced IPv4 prefixes. As seen in the below graph, the number of visible prefixes went up from less than 500 to around 3000.</p>
<img src="https://i.imgur.com/e1N87Yw.png" style="width: 800px" />
<p>There was also a decrease in the rate of unsolicited traffic observed by darknet around 22:32:00 GMT when the outage began and an increase to the normal rate at the end of the outage. The analysis of the darknet traffic also identified DoS attacks to the Egyptian government sites.</p>
<p><strong>Analysis - Libya:</strong></p>
<p>A single AS which is owned by the state dominates Libya’s Internet infrastructure, with only two submarine cables providing international connectivity, making it easier to manipulate. Libya encountered three outages as shown in the timeline.</p>
<p>During the first two outages, it was observed that 12 out of the 13 delegated prefixes to Libya were withdrawn by its local telecom operator with a reasonable exception of a prefix that was controlled by an outside company.  However, it was also observed that the darknet received some small traffic during the second outage suggesting that other censorship techniques might have been used.</p>
<p>During the third outage, it was observed that none of the BGP routes were withdrawn. Unlike the first two outages, where the primary technique was BGP disruption, the third outage was caused by packet filtering. This can be concluded by the small amount of traffic observed (shown in the below graph) by the darknet that is consistent with the behavior of packet filtering.</p>
<img src="https://i.imgur.com/NQKAx1F.png" style="width: 800px" />
<h3 id="connectivity-disruptions-detection"><a class="markdownIt-Anchor" href="#connectivity-disruptions-detection"></a> Connectivity Disruptions: Detection</h3>
<p>As we saw in a previous section, obtaining a view of global censorship can be challenging due to a variety of reasons. In this section, we focus on a system, <strong>Augur, which uses a measurement machine to detect filtering between hosts</strong>.</p>
<ul>
<li>Augur is a method and accompanying system that utilizes TCP/IP side channels to measure reachability (if there is any filtering) between Internet locations without directly controlling a measurement vantage point an either location)[Quiz]</li>
</ul>
<p>The system aims to <u>detect if filtering exists between two hosts</u>, a reflector and a site. A reflector is a host which maintains a global IP ID. A site is a host that may be potentially blocked. To identify if filtering exists, it makes use of a third machine called the measurement machine.</p>
<p><strong>IP ID:</strong></p>
<p>The strategy used by Augur takes advantage of the fact that any packet that is sent by a host is assigned a unique 16-bit IP identifier (“IP ID”), which the destination host can use to reassemble a fragmented packet. This IP ID should be different for the packets that are generated by the same host. Although there are multiple methods available to determine the IP ID of a packet (randomly, per-connection counter, etc.), maintaining a single global counter is the most commonly used approach. <u>The global counter is incremented for each packet that is generated and helps in keeping track of the total number of packets generated by that host.</u> Using this counter, we can determine if and how many packets are generated by a host.</p>
<p>In addition to the IP ID counter, the approach also leverages the fact that when an unexpected TCP packet is sent to a host, it sends back a RST (TCP Reset) packet. It also assumes there is no complex factors involved such as cross-traffic or packet loss.  Let’s look at two important mechanisms used by the approach:</p>
<p><strong>Probing:</strong></p>
<p>Probing is a mechanism to monitor the IP ID of a host over time. We use the measurement machine to observe the IP ID generated by the reflector. To do so, the measurement machine sends a <strong>TCP SYN-ACK</strong> to the reflector and receives a <strong>TCP RST</strong> packet as the response. <strong>The RST packet received would contain the latest IP ID</strong> that was generated by the reflector. Thus, the <strong>measurement machine can track the IP ID counter</strong> of the reflector at any given point.</p>
<p><strong>Perturbation</strong>:</p>
<p>This is a mechanism which forces a host to increment its IP ID counter by sending traffic from different sources such that the host generates a response packet. The flow here is as follows:</p>
<ol>
<li>The measurement machine sends a spoofed TCP SYN packet to the site with source address set to the reflector’s IP address.</li>
<li>The site responds to the reflector with a TCP SYN-ACK packet.</li>
<li>The reflector returns a TCP RST packet to the site while also incrementing its global IP ID counter by 1.</li>
<li>Now that we know how to probe and perturb the IP ID values at a host, let’s analyze the different possible scenarios. Let the initial IP ID counter of the reflector be 5.</li>
</ol>
<p><strong>No filtering</strong></p>
<p>Assume a scenario where there’s no filtering as shown in the below figure.</p>
<img src="https://i.imgur.com/aF0xI0P.png" style="width: 800px" />
<p>The sequence of events is as follows:</p>
<ol>
<li>The measurement machine probes the IP ID of the reflector by sending a TCP SYN-ACK packet. It receives a RST response packet with IP ID set to 6 (IPID (t1)).</li>
<li>Now, the measurement machine performs perturbation by sending a spoofed TCP SYN to the site.</li>
<li>The site sends a TCP SYN-ACK packet to the reflector and receives a RST packet as a response. The IP ID of the reflector is now incremented to 7.</li>
<li>The measurement machine again probes the IP ID of the reflector and receives a response with the IP ID value set to 8 (IPID (t4)).
<ul>
<li>So without filtering, the measure machine will see the IP ID from the reflector increased by 2.[Quiz]</li>
</ul>
</li>
</ol>
<p>The measurement machine thus observes that the difference in IP IDs between steps 1 and 4 is two and infers that communication has occurred between the two hosts.</p>
<p><strong>Inbound blocking</strong></p>
<p>The scenario where filtering occurs on the path from the site to the reflector is termed as inbound blocking. In this case, the SYN-ACK packet sent from the site in step 3 does not reach the reflector. Hence, there is no response generated and the IP ID of the reflector does not increase. The returned IP ID in step 4 will be 7 (IPID(t4)) as shown in the figure. Since the measurement machine observes the increment in IP ID value as 1, it detects filtering on the path from the site to the reflector.</p>
<ul>
<li><u>The IP ID only increased 1. [Quiz]</u></li>
</ul>
<img src="https://i.imgur.com/EA1IEwC.png" style="width: 800px" />
<p><strong>Outbound blocking</strong></p>
<p>Outbound blocking is the filtering imposed on the outgoing path from the reflector. Here, the reflector receives the SYN-ACK packet and generates a RST packet. As per our example, in step 3, the IP ID increments to 7. However, the RST packet does not reach the site. When the site doesn’t receive a RST packet, it continues to resend the SYN-ACK packets at regular intervals depending on the site’s OS and its configuration. This is shown in step 5 of the figure. It results in further increment of the IP ID value of the reflector. <u>In step 6, the probe by the measurement machine reveals the IP ID has again increased by 2,</u> which shows that retransmission of packets has occurred. In this way, outbound blocking can be detected.</p>
<ul>
<li><u>The IP ID is sent to measurement machine <strong>multiple times</strong> in a single request flow.</u></li>
</ul>
<img src="https://i.imgur.com/QJLUeRO.png" style="width: 800px" />
<h3 id="optional-censorship-over-social-media"><a class="markdownIt-Anchor" href="#optional-censorship-over-social-media"></a> Optional: Censorship Over Social Media</h3>
<p>The Censorship Over Social Media page is optional. Feel free to read through the papers referenced below to gain an understanding of how censorship takes place within the context of social media.</p>
<h2 id="references"><a class="markdownIt-Anchor" href="#references"></a> References:</h2>
<ul>
<li>Towards a Comprehensive Picture of the Great Firewall’s DNS Censorship
<ul>
<li><a target="_blank" rel="noopener" href="https://www.usenix.org/system/files/conference/foci14/foci14-anonymous.pdf">https://www.usenix.org/system/files/conference/foci14/foci14-anonymous.pdf</a></li>
</ul>
</li>
<li>Analysis of Country-wide Internet Outages Caused by Censorship
<ul>
<li><a target="_blank" rel="noopener" href="https://www.caida.org/publications/papers/2011/outages_censorship/outages_censorship.pdf">https://www.caida.org/publications/papers/2011/outages_censorship/outages_censorship.pdf</a></li>
</ul>
</li>
</ul>

</div>


  <div class="book-comments">
    




  </div>



<script src="/js/book-post.js"></script>


<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js" integrity="sha384-97gW6UIJxnlKemYavrqDHSX3SiygeOwIZhwyOKRfSaf0JWKRVj9hLASHgFTzT+0O" crossorigin="anonymous"></script>

<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>

        </div>
      </div>
      <div class="column col-2 hide-lg">
        <div class="book-post-info">
  
    <div class="book-post-meta">
  
  <div class="divider"></div>
</div>

  

  <div class="book-tocbot">
</div>
<div class="book-tocbot-menu">
  <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
  <a onclick="go_top()">Back to top</a>
  <a onclick="go_bottom()">Go to bottom</a>
</div>


<script src="/js/book-toc.js"></script>

</div>

      </div>
    </div>
  </div>
  
  <a class="off-canvas-overlay" onclick="hide_canvas()"></a>
</div>

</body>
</html>


<script src="/js/book.js"></script>
